var Pn=Object.defineProperty;var Bt=i=>{throw TypeError(i)};var Un=(i,e,t)=>e in i?Pn(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var v=(i,e,t)=>Un(i,typeof e!="symbol"?e+"":e,t),at=(i,e,t)=>e.has(i)||Bt("Cannot "+t);var s=(i,e,t)=>(at(i,e,"read from private field"),t?t.call(i):e.get(i)),S=(i,e,t)=>e.has(i)?Bt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),D=(i,e,t,n)=>(at(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),$=(i,e,t)=>(at(i,e,"access private method"),t);var ot=(i,e,t,n)=>({set _(r){D(i,e,r,t)},get _(){return s(i,e,n)}});import{e as In}from"./search-worker-entry-CiiqNvj2.js";class Zt{is(e){return this instanceof e}as(e){return this instanceof e?this:null}}class se extends Zt{constructor(){super()}get log(){return console.log.bind(console,this,this.toString())}}var F=(i=>(i[i.Forwards=1]="Forwards",i[i.Backwards=-1]="Backwards",i))(F||{});function On(i,e=!0){if(!e)return i;switch(i){case 1:return-1;case-1:return 1}}function Cn(i,e){return e===-1?Array.from(i).reverse():i}function Mn(i){return Array.from(i).reverse()}const ft=2147483647,dt="2^31 - 1",Kn=-2147483648;var de,pe;const We=class We extends se{constructor(t,n){super();S(this,de);S(this,pe);D(this,de,Oe(t)),D(this,pe,Oe(n))}get A(){return s(this,de)}get B(){return s(this,pe)}isIdentical(t){const n=t.as(We);return!!(n!=null&&n.A.isIdentical(this.A)&&(n!=null&&n.B.isIdentical(this.B)))}invert(){return new We(s(this,pe),s(this,de))}*experimentalExpand(t=F.Forwards,n){n??(n=1/0),n===0?yield t===F.Forwards?this:this.invert():t===F.Forwards?(yield*this.A.experimentalExpand(F.Forwards,n-1),yield*this.B.experimentalExpand(F.Forwards,n-1),yield*this.A.experimentalExpand(F.Backwards,n-1),yield*this.B.experimentalExpand(F.Backwards,n-1)):(yield*this.B.experimentalExpand(F.Forwards,n-1),yield*this.A.experimentalExpand(F.Forwards,n-1),yield*this.B.experimentalExpand(F.Backwards,n-1),yield*this.A.experimentalExpand(F.Backwards,n-1))}toString(t){return`[${s(this,de).toString(t)}, ${s(this,pe).toString(t)}]`}};de=new WeakMap,pe=new WeakMap;let C=We;var Le,Ee;const Qe=class Qe extends se{constructor(t,n){super();S(this,Le);S(this,Ee);D(this,Le,Oe(t)),D(this,Ee,Oe(n))}get A(){return s(this,Le)}get B(){return s(this,Ee)}isIdentical(t){const n=t.as(Qe);return!!(n!=null&&n.A.isIdentical(this.A)&&(n!=null&&n.B.isIdentical(this.B)))}invert(){return new Qe(s(this,Le),s(this,Ee).invert())}*experimentalExpand(t,n){n??(n=1/0),n===0?yield t===F.Forwards?this:this.invert():(yield*this.A.experimentalExpand(F.Forwards,n-1),yield*this.B.experimentalExpand(t,n-1),yield*this.A.experimentalExpand(F.Backwards,n-1))}toString(t){return`[${this.A.toString(t)}: ${this.B.toString(t)}]`}};Le=new WeakMap,Ee=new WeakMap;let M=Qe;var ie;const Et=class Et extends se{constructor(t){super();S(this,ie);if(t.includes(`
`)||t.includes("\r"))throw new Error("LineComment cannot contain newline");D(this,ie,t)}get text(){return s(this,ie)}isIdentical(t){const n=t;return t.is(Et)&&s(this,ie)===s(n,ie)}invert(){return this}*experimentalExpand(t=F.Forwards,n=1/0){yield this}toString(t){return`//${s(this,ie)}`}};ie=new WeakMap;let xe=Et;class j extends se{toString(e){return`
`}isIdentical(e){return e.is(j)}invert(){return this}*experimentalExpand(e=F.Forwards,t=1/0){yield this}}class P extends se{constructor(){super(...arguments);v(this,"experimentalNISSGrouping")}toString(t){return"."}isIdentical(t){return t.is(P)}invert(){return this}*experimentalExpand(t=F.Forwards,n=1/0){yield this}}var he;class Dt{constructor(){S(this,he,[])}push(e){s(this,he).push(e)}experimentalPushAlg(e){for(const t of e.childAlgNodes())this.push(t)}experimentalNumAlgNodes(){return s(this,he).length}toAlg(){return new p(s(this,he))}reset(){D(this,he,[])}}he=new WeakMap;function qe(i,e){return i?parseInt(i):e}const Nt=/^(\d+)?('?)/,Gn=/^[_\dA-Za-z]/,_n=/^((([1-9]\d*)-)?([1-9]\d*))?([_A-Za-z]+)/,qn=/^[^\n]*/,$n=/^(-?\d+), ?/,Wn=/^(-?\d+)\)/;function Jt(i){return new St().parseAlg(i)}function Qn(i){return new St().parseMove(i)}function Vn(i){return new St().parseQuantumMove(i)}const Pe=Symbol("startCharIndex"),Ue=Symbol("endCharIndex");function B(i,e,t){const n=i;return n[Pe]=e,n[Ue]=t,n}function Hn(i,e){return Pe in i&&(e[Pe]=i[Pe]),Ue in i&&(e[Ue]=i[Ue]),e}var U,g,be;class St{constructor(){S(this,U,"");S(this,g,0);S(this,be,[])}parseAlg(e){D(this,U,e),D(this,g,0);const t=this.parseAlgWithStopping([]);this.mustBeAtEndOfInput();const n=Array.from(t.childAlgNodes());if(s(this,be).length>0)for(const l of s(this,be).reverse())n.push(l);const r=new p(n),{[Pe]:a,[Ue]:c}=t;return B(r,a,c),r}parseMove(e){D(this,U,e),D(this,g,0);const t=this.parseMoveImpl();return this.mustBeAtEndOfInput(),t}parseQuantumMove(e){D(this,U,e),D(this,g,0);const t=this.parseQuantumMoveImpl();return this.mustBeAtEndOfInput(),t}mustBeAtEndOfInput(){if(s(this,g)!==s(this,U).length)throw new Error("parsing unexpectedly ended early")}parseAlgWithStopping(e){let t=s(this,g),n=s(this,g);const r=new Dt;let a=!1;const c=l=>{if(a)throw new Error(`Unexpected character at index ${l}. Are you missing a space?`)};e:for(;s(this,g)<s(this,U).length;){const l=s(this,g);if(e.includes(s(this,U)[s(this,g)]))return B(r.toAlg(),t,n);if(this.tryConsumeNext(" ")){a=!1,r.experimentalNumAlgNodes()===0&&(t=s(this,g));continue e}else if(Gn.test(s(this,U)[s(this,g)])){c(l);const f=this.parseMoveImpl();r.push(f),a=!0,n=s(this,g);continue e}else if(this.tryConsumeNext("(")){c(l);const f=this.tryRegex($n);if(f){const m=f[1],h=s(this,g),x=this.parseRegex(Wn),d=B(new o(new Q("U_SQ_"),parseInt(m)),l+1,l+1+m.length),y=B(new o(new Q("D_SQ_"),parseInt(x[1])),h,s(this,g)-1),w=B(new p([d,y]),l+1,s(this,g)-1);r.push(B(new G(w),l,s(this,g))),a=!0,n=s(this,g);continue e}else{const m=this.parseAlgWithStopping([")"]);this.mustConsumeNext(")");const h=this.parseAmount();r.push(B(new G(m,h),l,s(this,g))),a=!0,n=s(this,g);continue e}}else if(this.tryConsumeNext("^")){this.mustConsumeNext("(");const f=this.parseAlgWithStopping([")"]);this.popNext();const m=new G(f,-1),h=new P;m.experimentalNISSPlaceholder=h,h.experimentalNISSGrouping=m,s(this,be).push(m),r.push(h)}else if(this.tryConsumeNext("[")){c(l);const f=this.parseAlgWithStopping([",",":"]),m=this.popNext(),h=this.parseAlgWithStopping(["]"]);this.mustConsumeNext("]");let x;switch(m){case":":{x=B(new M(f,h),l,s(this,g)),a=!0,n=s(this,g);break}case",":{x=B(new C(f,h),l,s(this,g)),a=!0,n=s(this,g);break}default:throw new Error("unexpected parsing error")}const d=s(this,g),y=this.parseAmount();if(y===1)r.push(x);else{const w=B(new p([x]),l,d),R=B(new G(w,y),l,s(this,g));r.push(R)}a=!0,n=s(this,g);continue e}else if(this.tryConsumeNext(`
`)){r.push(B(new j,l,s(this,g))),a=!1,n=s(this,g);continue e}else if(this.tryConsumeNext("/"))if(this.tryConsumeNext("/")){c(l);const[f]=this.parseRegex(qn);r.push(B(new xe(f),l,s(this,g))),a=!1,n=s(this,g);continue e}else{r.push(B(new o("_SLASH_"),l,s(this,g))),a=!0,n=s(this,g);continue e}else if(this.tryConsumeNext(".")){c(l),r.push(B(new P,l,s(this,g))),a=!0,n=s(this,g);continue e}else throw new Error(`Unexpected character: ${this.popNext()}`)}if(s(this,g)!==s(this,U).length)throw new Error("did not finish parsing?");if(e.length>0)throw new Error("expected stopping");return B(r.toAlg(),t,n)}parseQuantumMoveImpl(){const[,,,e,t,n]=this.parseRegex(_n);return new Q(n,qe(t,void 0),qe(e,void 0))}parseMoveImpl(){const e=s(this,g);if(this.tryConsumeNext("/"))return B(new o("_SLASH_"),e,s(this,g));let t=this.parseQuantumMoveImpl(),[n,r]=this.parseAmountAndTrackEmptyAbsAmount();const a=this.parseMoveSuffix();if(a){if(n<0)throw new Error("uh-oh");if((a==="++"||a==="--")&&n!==1)throw new Error("Pochmann ++ or -- moves cannot have an amount other than 1.");if((a==="++"||a==="--")&&!r)throw new Error("Pochmann ++ or -- moves cannot have an amount written as a number.");if((a==="+"||a==="-")&&r)throw new Error("Clock dial moves must have an amount written as a natural number followed by + or -.");a.startsWith("+")&&(t=t.modified({family:`${t.family}_${a==="+"?"PLUS":"PLUSPLUS"}_`})),a.startsWith("-")&&(t=t.modified({family:`${t.family}_${a==="-"?"PLUS":"PLUSPLUS"}_`}),n*=-1)}return B(new o(t,n),e,s(this,g))}parseMoveSuffix(){return this.tryConsumeNext("+")?this.tryConsumeNext("+")?"++":"+":this.tryConsumeNext("-")?this.tryConsumeNext("-")?"--":"-":null}parseAmountAndTrackEmptyAbsAmount(){const e=s(this,g),[,t,n]=this.parseRegex(Nt);if(t!=null&&t.startsWith("0")&&t!=="0")throw new Error(`Error at char index ${e}: An amount can only start with 0 if it's exactly the digit 0.`);return[qe(t,1)*(n==="'"?-1:1),!t]}parseAmount(){const e=s(this,g),[,t,n]=this.parseRegex(Nt);if(t!=null&&t.startsWith("0")&&t!=="0")throw new Error(`Error at char index ${e}: An amount number can only start with 0 if it's exactly the digit 0.`);return qe(t,1)*(n==="'"?-1:1)}parseRegex(e){const t=e.exec(this.remaining());if(t===null)throw new Error("internal parsing error");return D(this,g,s(this,g)+t[0].length),t}tryRegex(e){const t=e.exec(this.remaining());return t===null?null:(D(this,g,s(this,g)+t[0].length),t)}remaining(){return s(this,U).slice(s(this,g))}popNext(){const e=s(this,U)[s(this,g)];return ot(this,g)._++,e}tryConsumeNext(e){return s(this,U)[s(this,g)]===e?(ot(this,g)._++,!0):!1}mustConsumeNext(e){const t=this.popNext();if(t!==e)throw new Error(`expected \`${e}\` while parsing, encountered ${t}`);return t}}U=new WeakMap,g=new WeakMap,be=new WeakMap;const zt=new Set;function Yt(i){zt.has(i)||(console.warn(i),zt.add(i))}class pt{constructor(e,t=1){v(this,"quantum");v(this,"amount");if(this.quantum=e,this.amount=t,!Number.isInteger(this.amount)||this.amount<Kn||this.amount>ft)throw new Error(`AlgNode amount absolute value must be a non-negative integer below ${dt}.`)}suffix(){let e="";const t=Math.abs(this.amount);return t!==1&&(e+=t),this.amount<0&&(e+="'"),e}isIdentical(e){return this.quantum.isIdentical(e.quantum)&&this.amount===e.amount}*experimentalExpand(e,t){const n=Math.abs(this.amount),r=On(e,this.amount<0);for(let a=0;a<n;a++)yield*this.quantum.experimentalExpand(r,t)}}var X,A,k;const Ve=class Ve extends Zt{constructor(t,n,r){super();S(this,X);S(this,A);S(this,k);if(D(this,X,t),D(this,A,n??null),D(this,k,r??null),Object.freeze(this),s(this,A)!==null&&(!Number.isInteger(s(this,A))||s(this,A)<1||s(this,A)>ft))throw new Error(`QuantumMove inner layer must be a positive integer below ${dt}.`);if(s(this,k)!==null&&(!Number.isInteger(s(this,k))||s(this,k)<1||s(this,k)>ft))throw new Error(`QuantumMove outer layer must be a positive integer below ${dt}.`);if(s(this,k)!==null&&s(this,A)!==null&&s(this,A)<=s(this,k))throw new Error("QuantumMove outer layer must be smaller than inner layer.");if(s(this,k)!==null&&s(this,A)===null)throw new Error("QuantumMove with an outer layer must have an inner layer")}static fromString(t){return Vn(t)}modified(t){return new Ve(t.family??s(this,X),t.innerLayer??s(this,A),t.outerLayer??s(this,k))}isIdentical(t){const n=t;return t.is(Ve)&&s(this,X)===s(n,X)&&s(this,A)===s(n,A)&&s(this,k)===s(n,k)}get family(){return s(this,X)}get outerLayer(){return s(this,k)}get innerLayer(){return s(this,A)}experimentalExpand(){throw new Error("experimentalExpand() cannot be called on a `QuantumMove` directly.")}toString(t){let n=s(this,X);return s(this,A)!==null&&(n=String(s(this,A))+n,s(this,k)!==null&&(n=`${String(s(this,k))}-${n}`)),n}};X=new WeakMap,A=new WeakMap,k=new WeakMap;let Q=Ve;var z,He,Ke,ht;const me=class me extends se{constructor(...t){super();S(this,Ke);S(this,z);S(this,He);if(typeof t[0]=="string")if(t[1]??null){D(this,z,new pt(Q.fromString(t[0]),t[1]));return}else return me.fromString(t[0]);D(this,z,new pt(t[0],t[1]))}isIdentical(t){const n=t.as(me);return!!n&&s(this,z).isIdentical(s(n,z))}invert(){return Hn(this,new me(s(this,z).quantum,$(this,Ke,ht).call(this)?this.amount:-this.amount))}*experimentalExpand(t=F.Forwards){t===F.Forwards?yield this:yield this.modified({amount:-this.amount})}get quantum(){return s(this,z).quantum}modified(t){return new me(s(this,z).quantum.modified(t),t.amount??this.amount)}static fromString(t){return Qn(t)}get amount(){return s(this,z).amount}get type(){return Yt("deprecated: type"),"blockMove"}get family(){return s(this,z).quantum.family??void 0}get outerLayer(){return s(this,z).quantum.outerLayer??void 0}get innerLayer(){return s(this,z).quantum.innerLayer??void 0}toString(t){if((t==null?void 0:t.notation)!=="LGN"){if($(this,Ke,ht).call(this))return"/";if(this.family.endsWith("_PLUS_"))return s(this,z).quantum.toString().slice(0,-6)+Math.abs(this.amount)+(this.amount<0?"-":"+");if(this.family.endsWith("_PLUSPLUS_")){const n=Math.abs(this.amount);return s(this,z).quantum.toString().slice(0,-10)+(n===1?"":n)+(this.amount<0?"--":"++")}}return s(this,z).quantum.toString(t)+s(this,z).suffix()}};z=new WeakMap,He=new WeakMap,Ke=new WeakSet,ht=function(){return this.isIdentical(s(this,He)??D(this,He,new me("_SLASH_")))};let o=me;class Zn{constructor(){v(this,"quantumU_SQ_",null);v(this,"quantumD_SQ_",null)}format(e,t){if((t==null?void 0:t.notation)==="LGN"||e.amount!==1)return null;const n=this.tuple(e);return n?`(${n.map(r=>r.amount).join(", ")})`:null}tuple(e){var n,r;if(e.amount!==1)return null;this.quantumU_SQ_||(this.quantumU_SQ_=new Q("U_SQ_")),this.quantumD_SQ_||(this.quantumD_SQ_=new Q("D_SQ_"));const t=e.alg;if(t.experimentalNumChildAlgNodes()===2){const[a,c]=t.childAlgNodes();if((n=a.as(o))!=null&&n.quantum.isIdentical(this.quantumU_SQ_)&&((r=c.as(o))!=null&&r.quantum.isIdentical(this.quantumD_SQ_)))return[a,c]}return null}}const st=new Zn;var I,Ze,Xt;const Ie=class Ie extends se{constructor(t,n){super();S(this,Ze);S(this,I);v(this,"experimentalNISSPlaceholder");const r=Oe(t);D(this,I,new pt(r,n))}isIdentical(t){const n=t;return t.is(Ie)&&s(this,I).isIdentical(s(n,I))}get alg(){return s(this,I).quantum}get amount(){return s(this,I).amount}get experimentalRepetitionSuffix(){return s(this,I).suffix()}invert(){const t=st.tuple(this);if(t){const[n,r]=t;return new Ie(new p([n.invert(),r.invert()]))}return new Ie(s(this,I).quantum,-s(this,I).amount)}*experimentalExpand(t=F.Forwards,n){n??(n=1/0),n===0?yield t===F.Forwards?this:this.invert():yield*s(this,I).experimentalExpand(t,n-1)}static fromString(){throw new Error("unimplemented")}toString(t){return st.format(this,t)??`${$(this,Ze,Xt).call(this,t)}${s(this,I).suffix()}`}experimentalAsSquare1Tuple(){return st.tuple(this)}};I=new WeakMap,Ze=new WeakSet,Xt=function(t){const n=s(this,I).quantum.toString(t),r=this.alg.childAlgNodes(),{value:a}=r.next();return r.next().done&&(a!=null&&a.is(C)||a!=null&&a.is(M))?n:`(${n})`};let G=Ie;function Y(i,e){return i instanceof e}function Jn(i){return Y(i,G)||Y(i,xe)||Y(i,C)||Y(i,M)||Y(i,o)||Y(i,j)||Y(i,P)}function jt(i,e,t){if(e.is(G))return i.traverseGrouping(e,t);if(e.is(o))return i.traverseMove(e,t);if(e.is(C))return i.traverseCommutator(e,t);if(e.is(M))return i.traverseConjugate(e,t);if(e.is(P))return i.traversePause(e,t);if(e.is(j))return i.traverseNewline(e,t);if(e.is(xe))return i.traverseLineComment(e,t);throw new Error("unknown AlgNode")}function en(i){if(i.is(G)||i.is(o)||i.is(C)||i.is(M)||i.is(P)||i.is(j)||i.is(xe))return i;throw new Error("internal error: expected AlgNode")}class Rt{traverseAlgNode(e,t){return jt(this,e,t)}traverseIntoAlgNode(e,t){return en(this.traverseAlgNode(e,t))}}class vt extends Rt{traverseAlgNode(e){return jt(this,e,void 0)}traverseIntoAlgNode(e){return en(this.traverseAlgNode(e))}}function ue(i,e){const t=new i(...e??[]);return t.traverseAlg.bind(t)}const Yn="any-direction";class tn{constructor(e={}){this.config=e}cancelQuantum(){const{cancel:e}=this.config;return e===!0?Yn:e===!1?"none":(e==null?void 0:e.directional)??"none"}cancelAny(){return this.config.cancel&&this.cancelQuantum()!=="none"}cancelPuzzleSpecificModWrap(){const{cancel:e}=this.config;return e===!0||e===!1?"canonical-centered":e!=null&&e.puzzleSpecificModWrap?e==null?void 0:e.puzzleSpecificModWrap:(e==null?void 0:e.directional)==="same-direction"?"preserve-sign":"canonical-centered"}puzzleSpecificSimplifyOptions(){var e;return((e=this.config.puzzleLoader)==null?void 0:e.puzzleSpecificSimplifyOptions)??this.config.puzzleSpecificSimplifyOptions}}function Xn(i,e){return i*Math.sign(e.amount)>=0}function jn(i,e,t=0){return((i-t)%e+e)%e+t}function er(i,e,t){var f;const n=new tn(t),r=Array.from(i.childAlgNodes());let a=[e];function c(){return new p([...r,...a])}function l(m){var w;if(n.cancelPuzzleSpecificModWrap()==="none")return m;const h=(w=n.puzzleSpecificSimplifyOptions())==null?void 0:w.quantumMoveOrder;if(!h)return m;const x=h(e.quantum);let d;switch(n.cancelPuzzleSpecificModWrap()){case"gravity":{d=-Math.floor((x-(m.amount<0?0:1))/2);break}case"canonical-centered":{d=-Math.floor((x-1)/2);break}case"canonical-positive":{d=0;break}case"preserve-sign":{d=m.amount<0?1-x:0;break}default:throw new Error("Unknown mod wrap")}const y=jn(m.amount,x,d);return m.modified({amount:y})}if(n.cancelAny()){let m;const h=(f=n.puzzleSpecificSimplifyOptions())==null?void 0:f.axis;if(h)m=R=>h.areQuantumMovesSameAxis(e.quantum,R.quantum);else{const R=e.quantum.toString();m=q=>q.quantum.toString()===R}const x=n.cancelQuantum()==="same-direction",d=new Map;d.set(e.quantum.toString(),Math.sign(e.amount));let y;for(y=r.length-1;y>=0;y--){const R=r[y].as(o);if(!R||!m(R))break;const q=R.quantum.toString();if(x){const ee=d.get(q);if(ee&&!Xn(ee,R))break;d.set(q,Math.sign(R.amount))}}const w=[...r.splice(y+1),e];if(h)a=h.simplifySameAxisMoves(w,n.cancelPuzzleSpecificModWrap()!=="none");else{const R=w.reduce((q,ee)=>q+ee.amount,0);if(d.size!==1)throw new Error("Internal error: multiple quantums when one was expected");a=[new o(e.quantum,R)]}}return a=a.map(m=>l(m)).filter(m=>m.amount!==0),c()}function tr(i,e,t){const n=e.as(o);return n?er(i,n,t):new p([...i.childAlgNodes(),e])}var Je,_,wt,ke,gt;class nr extends Rt{constructor(){super(...arguments);S(this,_);S(this,Je)}*traverseAlg(t,n){if(n.depth===0){yield*t.childAlgNodes();return}let r=[];const a=$(this,_,ke).call(this,n);for(const c of t.childAlgNodes())for(const l of this.traverseAlgNode(c,a))r=Array.from(tr(new p(r),l,a).childAlgNodes());for(const c of r)yield c}*traverseGrouping(t,n){if(n.depth===0){yield t;return}if(t.amount===0)return;const r=new G(this.traverseAlg(t.alg,$(this,_,ke).call(this,n)),t.amount);if(r.alg.experimentalIsEmpty())return;const a=$(this,_,wt).call(this).get(t);a&&(r.experimentalNISSPlaceholder=a,a.experimentalNISSGrouping=r),yield r}*traverseMove(t,n){yield t}*traverseCommutator(t,n){if(n.depth===0){yield t;return}const r=$(this,_,ke).call(this,n),a=new C(this.traverseAlg(t.A,r),this.traverseAlg(t.B,r));a.A.experimentalIsEmpty()||a.B.experimentalIsEmpty()||a.A.isIdentical(a.B)||a.A.isIdentical(a.B.invert())||$(this,_,gt).call(this,a.A,a.B,n)||(yield a)}*traverseConjugate(t,n){if(n.depth===0){yield t;return}const r=$(this,_,ke).call(this,n),a=new M(this.traverseAlg(t.A,r),this.traverseAlg(t.B,r));if(!a.B.experimentalIsEmpty()){if(a.A.experimentalIsEmpty()||a.A.isIdentical(a.B)||a.A.isIdentical(a.B.invert())||$(this,_,gt).call(this,a.A,a.B,n)){yield*t.B.childAlgNodes();return}yield a}}*traversePause(t,n){if(t.experimentalNISSGrouping){const r=new P;$(this,_,wt).call(this).set(t.experimentalNISSGrouping,r),yield r}else yield t}*traverseNewline(t,n){yield t}*traverseLineComment(t,n){yield t}}Je=new WeakMap,_=new WeakSet,wt=function(){return s(this,Je)??D(this,Je,new Map)},ke=function(t){return{...t,depth:t.depth?t.depth-1:null}},gt=function(t,n,r){var a,c,l,f;if(t.experimentalNumChildAlgNodes()===1&&n.experimentalNumChildAlgNodes()===1){const m=(a=Array.from(t.childAlgNodes())[0])==null?void 0:a.as(o),h=(c=Array.from(n.childAlgNodes())[0])==null?void 0:c.as(o);if(!(m&&h))return!1;if(h.quantum.isIdentical(m.quantum)||(f=(l=new tn(r).puzzleSpecificSimplifyOptions())==null?void 0:l.axis)!=null&&f.areQuantumMovesSameAxis(m.quantum,h.quantum))return!0}return!1};const rr=ue(nr);function At(i){if(!i)return[];if(Y(i,p))return i.childAlgNodes();if(typeof i=="string")return Jt(i).childAlgNodes();const e=i;if(typeof e[Symbol.iterator]=="function")return e;throw new Error("Invalid AlgNode")}function Oe(i){return Y(i,p)?i:new p(i)}var O;const fe=class fe extends se{constructor(t){super();S(this,O);D(this,O,Array.from(At(t)));for(const n of s(this,O))if(!Jn(n))throw new Error("An alg can only contain alg nodes.")}isIdentical(t){const n=t;if(!t.is(fe))return!1;const r=Array.from(s(this,O)),a=Array.from(s(n,O));if(r.length!==a.length)return!1;for(let c=0;c<r.length;c++)if(!r[c].isIdentical(a[c]))return!1;return!0}invert(){return new fe(Mn(Array.from(s(this,O)).map(t=>t.invert())))}*experimentalExpand(t=F.Forwards,n){n??(n=1/0);for(const r of Cn(s(this,O),t))yield*r.experimentalExpand(t,n)}expand(t){return new fe(this.experimentalExpand(F.Forwards,(t==null?void 0:t.depth)??1/0))}*experimentalLeafMoves(){for(const t of this.experimentalExpand())t.is(o)&&(yield t)}concat(t){return new fe(Array.from(s(this,O)).concat(Array.from(At(t))))}experimentalIsEmpty(){for(const t of s(this,O))return!1;return!0}static fromString(t){return Jt(t)}units(){return this.childAlgNodes()}*childAlgNodes(){for(const t of s(this,O))yield t}experimentalNumUnits(){return this.experimentalNumChildAlgNodes()}experimentalNumChildAlgNodes(){return Array.from(s(this,O)).length}get type(){return Yt("deprecated: type"),"sequence"}toString(t){var a,c;let n="",r=null;for(const l of s(this,O)){r&&(n+=ir(r,l));const f=(a=l.as(P))==null?void 0:a.experimentalNISSGrouping;if(f){if(f.amount!==-1)throw new Error("Invalid NISS Grouping amount!");n+=`^(${f.alg.toString(t)})`}else(c=l.as(G))!=null&&c.experimentalNISSPlaceholder||(n+=l.toString(t));r=l}return n}experimentalSimplify(t){return new fe(rr(this,t??{}))}simplify(t){return this.experimentalSimplify(t)}};O=new WeakMap;let p=fe;function ir(i,e){var t;return i.is(j)||e.is(j)||(t=e.as(G))!=null&&t.experimentalNISSPlaceholder?"":i.is(xe)&&!e.is(j)?`
`:" "}new p([new o("R",1),new o("U",1),new o("R",-1),new o("U",1),new o("R",1),new o("U",-2),new o("R",-1)]),new p([new o("R",1),new o("U",2),new o("R",-1),new o("U",-1),new o("R",1),new o("U",-1),new o("R",-1)]),new p([new C(new p([new o("R",1),new o("U",1),new o("R",-2)]),new p([new M(new p([new o("R",1)]),new p([new o("U",1)]))]))]),new p([new o("R",1),new o("U",-1),new o("L",-1),new o("U",1),new o("R",-1),new o("U",-1),new o("L",1),new o("U",1)]),new p([new o("x",-1),new C(new p([new M(new p([new o("R",1)]),new p([new o("U",-1)]))]),new p([new o("D",1)])),new C(new p([new M(new p([new o("R",1)]),new p([new o("U",1)]))]),new p([new o("D",1)])),new o("x",1)]),new p([new M(new p([new o("F",1)]),new p([new C(new p([new o("U",1)]),new p([new o("R",1)]))]))]),new p([new M(new p([new o("R",2)]),new p([new C(new p([new o("F",2)]),new p([new o("R",-1),new o("B",-1),new o("R",1)]))]))]),new p([new o("F",1),new o("U",1),new o("R",1),new o("U",-1),new o("R",-1),new o("F",-1)]),new p([new o("R",1),new o("U",1),new o("R",-1),new o("U",-1),new o("R",-1),new o("F",1),new o("R",2),new o("U",-1),new o("R",-1),new o("U",-1),new o("R",1),new o("U",1),new o("R",-1),new o("F",-1)]),new p([new M(new p([new o("F",1)]),new p([new G(new p([new C(new p([new o("R",1)]),new p([new o("U",1)]))]),3)]))]),new p([new P,new P,new P]);function xt(i,e,t){const n={};for(const r of i.orbits){const a=e[r.orbitName],c=t[r.orbitName];if($e(r.numOrientations,c))n[r.orbitName]=a;else if($e(r.numOrientations,a))n[r.orbitName]=c;else{const l=new Array(r.numPieces);if(r.numOrientations===1){for(let f=0;f<r.numPieces;f++)l[f]=a.permutation[c.permutation[f]];n[r.orbitName]={permutation:l,orientationDelta:a.orientationDelta}}else{const f=new Array(r.numPieces);for(let m=0;m<r.numPieces;m++)f[m]=(a.orientationDelta[c.permutation[m]]+c.orientationDelta[m])%r.numOrientations,l[m]=a.permutation[c.permutation[m]];n[r.orbitName]={permutation:l,orientationDelta:f}}}}return n}function kt(i,e,t){const n={};for(const r of i.orbits){const a=e[r.orbitName],c=t[r.orbitName];if($e(r.numOrientations,c))n[r.orbitName]=a;else{const l=new Array(r.numPieces);if(r.numOrientations===1){for(let m=0;m<r.numPieces;m++)l[m]=a.pieces[c.permutation[m]];const f={pieces:l,orientation:a.orientation};n[r.orbitName]=f}else{const f=new Array(r.numPieces),m=a.orientationMod?new Array(r.numPieces):void 0;for(let x=0;x<r.numPieces;x++){const d=c.permutation[x];let y=r.numOrientations;if(a.orientationMod){const w=a.orientationMod[d];m[x]=w,y=w||r.numOrientations}f[x]=(a.orientation[d]+c.orientationDelta[x])%y,l[x]=a.pieces[d]}const h={pieces:l,orientation:f};m&&(h.orientationMod=m),n[r.orbitName]=h}}}return n}const Tt=new Map;function ar(i){const e=Tt.get(i);if(e)return e;const t=new Array(i),n=new Array(i);for(let a=0;a<i;a++)t[a]=a,n[a]=0;const r={permutation:t,orientationDelta:n};return Tt.set(i,r),r}function or(i){const e={};for(const t of i.orbits)e[t.orbitName]=ar(t.numPieces);return e}function sr(i,e){function t(r,a){var m;const c=r.toString(),l=i.definition.moves[c];if(l)return Ne(i,l,a);const f=(m=i.definition.derivedMoves)==null?void 0:m[c];if(f)return Ne(i,i.algToTransformation(f).transformationData,a)}const n=t(e.quantum,e.amount)??t(e,1)??t(e.invert,-1);if(n)return n;throw new Error(`Invalid move for KPuzzle (${i.name()}): ${e}`)}class T{constructor(e,t){this.kpuzzle=e,this.patternData=t}toJSON(){return{experimentalPuzzleName:this.kpuzzle.name(),patternData:this.patternData}}static fromTransformation(e){const t=kt(e.kpuzzle.definition,e.kpuzzle.definition.defaultPattern,e.transformationData);return new T(e.kpuzzle,t)}apply(e){return this.applyTransformation(this.kpuzzle.toTransformation(e))}applyTransformation(e){if(e.isIdentityTransformation())return new T(this.kpuzzle,this.patternData);const t=kt(this.kpuzzle.definition,this.patternData,e.transformationData);return new T(this.kpuzzle,t)}applyMove(e){return this.applyTransformation(this.kpuzzle.moveToTransformation(e))}applyAlg(e){return this.applyTransformation(this.kpuzzle.algToTransformation(e))}isIdentical(e){return mr(this.kpuzzle,this.patternData,e.patternData)}experimentalToTransformation(){if(!this.kpuzzle.canConvertDefaultPatternToUniqueTransformation())return null;const e={};for(const[t,n]of Object.entries(this.patternData)){const r={permutation:n.pieces,orientationDelta:n.orientation};e[t]=r}return new ae(this.kpuzzle,e)}experimentalIsSolved(e){if(!this.kpuzzle.definition.experimentalIsPatternSolved)throw new Error("`KPattern.experimentalIsPatternSolved()` is not supported for this puzzle at the moment.");return this.kpuzzle.definition.experimentalIsPatternSolved(this,e)}}var we;const ne=class ne{constructor(e,t){S(this,we);this.kpuzzle=e,this.transformationData=t}toJSON(){return{experimentalPuzzleName:this.kpuzzle.name(),transformationData:this.transformationData}}invert(){return new ne(this.kpuzzle,nn(this.kpuzzle,this.transformationData))}isIdentityTransformation(){return s(this,we)??D(this,we,this.isIdentical(this.kpuzzle.identityTransformation()))}static experimentalConstructIdentity(e){const t=new ne(e,or(e.definition));return D(t,we,!0),t}isIdentical(e){return cr(this.kpuzzle,this.transformationData,e.transformationData)}apply(e){return this.applyTransformation(this.kpuzzle.toTransformation(e))}applyTransformation(e){if(this.kpuzzle!==e.kpuzzle)throw new Error(`Tried to apply a transformation for a KPuzzle (${e.kpuzzle.name()}) to a different KPuzzle (${this.kpuzzle.name()}).`);return s(this,we)?new ne(this.kpuzzle,e.transformationData):s(e,we)?new ne(this.kpuzzle,this.transformationData):new ne(this.kpuzzle,xt(this.kpuzzle.definition,this.transformationData,e.transformationData))}applyMove(e){return this.applyTransformation(this.kpuzzle.moveToTransformation(e))}applyAlg(e){return this.applyTransformation(this.kpuzzle.algToTransformation(e))}toKPattern(){return T.fromTransformation(this)}repetitionOrder(){return pr(this.kpuzzle.definition,this)}selfMultiply(e){return new ne(this.kpuzzle,Ne(this.kpuzzle,this.transformationData,e))}};we=new WeakMap;let ae=ne;function $e(i,e){e.permutation||console.log(e);const{permutation:t}=e,n=t.length;for(let r=0;r<n;r++)if(t[r]!==r)return!1;if(i>1){const{orientationDelta:r}=e;for(let a=0;a<n;a++)if(r[a]!==0)return!1}return!0}function ur(i,e,t,n={}){for(let r=0;r<i.numPieces;r++)if(!(n!=null&&n.ignorePieceOrientations)&&e.orientationDelta[r]!==t.orientationDelta[r]||!(n!=null&&n.ignorePiecePermutation)&&e.permutation[r]!==t.permutation[r])return!1;return!0}function cr(i,e,t){for(const n of i.definition.orbits)if(!ur(n,e[n.orbitName],t[n.orbitName]))return!1;return!0}function lr(i,e,t,n={}){var r,a;for(let c=0;c<i.numPieces;c++)if(!(n!=null&&n.ignorePieceOrientations)&&(e.orientation[c]!==t.orientation[c]||(((r=e.orientationMod)==null?void 0:r[c])??0)!==(((a=t.orientationMod)==null?void 0:a[c])??0))||!(n!=null&&n.ignorePieceIndices)&&e.pieces[c]!==t.pieces[c])return!1;return!0}function mr(i,e,t){for(const n of i.definition.orbits)if(!lr(n,e[n.orbitName],t[n.orbitName]))return!1;return!0}function nn(i,e){const t={};for(const n of i.definition.orbits){const r=e[n.orbitName];if($e(n.numOrientations,r))t[n.orbitName]=r;else if(n.numOrientations===1){const a=new Array(n.numPieces);for(let c=0;c<n.numPieces;c++)a[r.permutation[c]]=c;t[n.orbitName]={permutation:a,orientationDelta:r.orientationDelta}}else{const a=new Array(n.numPieces),c=new Array(n.numPieces);for(let l=0;l<n.numPieces;l++){const f=r.permutation[l];a[f]=l,c[f]=(n.numOrientations-r.orientationDelta[l]+n.numOrientations)%n.numOrientations}t[n.orbitName]={permutation:a,orientationDelta:c}}}return t}function Ne(i,e,t){if(t===1)return e;if(t<0)return Ne(i,nn(i,e),-t);if(t===0){const{transformationData:a}=i.identityTransformation();return a}let n=e;t!==2&&(n=Ne(i,e,Math.floor(t/2)));const r=xt(i.definition,n,n);return t%2===0?r:xt(i.definition,e,r)}class fr extends Rt{traverseAlg(e,t){let n=null;for(const r of e.childAlgNodes())n?n=n.applyTransformation(this.traverseAlgNode(r,t)):n=this.traverseAlgNode(r,t);return n??t.identityTransformation()}traverseGrouping(e,t){const n=this.traverseAlg(e.alg,t);return new ae(t,Ne(t,n.transformationData,e.amount))}traverseMove(e,t){return t.moveToTransformation(e)}traverseCommutator(e,t){const n=this.traverseAlg(e.A,t),r=this.traverseAlg(e.B,t);return n.applyTransformation(r).applyTransformation(n.invert()).applyTransformation(r.invert())}traverseConjugate(e,t){const n=this.traverseAlg(e.A,t),r=this.traverseAlg(e.B,t);return n.applyTransformation(r).applyTransformation(n.invert())}traversePause(e,t){return t.identityTransformation()}traverseNewline(e,t){return t.identityTransformation()}traverseLineComment(e,t){return t.identityTransformation()}}const dr=ue(fr);function yt(i,e){return e?yt(e,i%e):i}function pr(i,e){let t=1;for(const n of i.orbits){const r=e.transformationData[n.orbitName],a=new Array(n.numPieces);for(let c=0;c<n.numPieces;c++)if(!a[c]){let l=c,f=0,m=0;for(;a[l]=!0,f=f+r.orientationDelta[l],m=m+1,l=r.permutation[l],l!==c;);f!==0&&(m=m*n.numOrientations/yt(n.numOrientations,Math.abs(f))),t=t*m/yt(t,m)}}return t}var Ge,Be,Ye;class Z{constructor(e,t){v(this,"experimentalPGNotation");S(this,Ge);S(this,Be,new Map);S(this,Ye);this.definition=e,this.experimentalPGNotation=t==null?void 0:t.experimentalPGNotation}lookupOrbitDefinition(e){return s(this,Ge)||D(this,Ge,(()=>{const t={};for(const n of this.definition.orbits)t[n.orbitName]=n;return t})()),s(this,Ge)[e]}name(){return this.definition.name}identityTransformation(){return ae.experimentalConstructIdentity(this)}moveToTransformation(e){typeof e=="string"&&(e=new o(e));const t=e.toString(),n=s(this,Be).get(t);if(n)return new ae(this,n);if(this.experimentalPGNotation){const a=this.experimentalPGNotation.lookupMove(e);if(!a)throw new Error(`could not map to internal move: ${e}`);return s(this,Be).set(t,a),new ae(this,a)}const r=sr(this,e);return s(this,Be).set(t,r),new ae(this,r)}algToTransformation(e){return typeof e=="string"&&(e=new p(e)),dr(e,this)}toTransformation(e){var t,n;return typeof e=="string"?this.algToTransformation(e):(t=e==null?void 0:e.is)!=null&&t.call(e,p)?this.algToTransformation(e):(n=e==null?void 0:e.is)!=null&&n.call(e,o)?this.moveToTransformation(e):e}defaultPattern(){return new T(this,this.definition.defaultPattern)}canConvertDefaultPatternToUniqueTransformation(){return s(this,Ye)??D(this,Ye,(()=>{for(const e of this.definition.orbits){const t=new Array(e.numPieces).fill(!1);for(const n of this.definition.defaultPattern[e.orbitName].pieces)t[n]=!0;for(const n of t)if(!n)return!1}return!0})())}}Ge=new WeakMap,Be=new WeakMap,Ye=new WeakMap;class Fe extends Promise{constructor(e){super(t=>{t()}),this._executor=e}static from(e){return new Fe(t=>{t(e())})}static resolve(e){return new Fe(t=>{t(e)})}static reject(e){return new Fe((t,n)=>{n(e)})}then(e,t){return this._promise=this._promise||new Promise(this._executor),this._promise.then(e,t)}catch(e){return this._promise=this._promise||new Promise(this._executor),this._promise.catch(e)}}function V(i){return new Fe(e=>{e(i())})}var u=(i=>(i.Regular="Regular",i.Dim="Dim",i.Ignored="Ignored",i.OrientationStickers="OrientationStickers",i.Invisible="Invisible",i.Ignoriented="Ignoriented",i.IgnoreNonPrimary="IgnoreNonPrimary",i.PermuteNonPrimary="PermuteNonPrimary",i.OrientationWithoutPermutation="OrientationWithoutPermutation",i.ExperimentalOrientationWithoutPermutation2="ExperimentalOrientationWithoutPermutation2",i.Mystery="Mystery",i))(u||{});class le{constructor(e,t){v(this,"stickerings",new Map);for(const n of e.definition.orbits)this.stickerings.set(n.orbitName,new Array(n.numPieces).fill(t))}}const H="regular",E="ignored",Re="oriented",hr="experimentalOriented2",ze="invisible",ce="dim",Ae="mystery",wr={Regular:{facelets:[H,H,H,H,H]},Ignored:{facelets:[E,E,E,E,E]},OrientationStickers:{facelets:[Re,Re,Re,Re,Re]},IgnoreNonPrimary:{facelets:[H,E,E,E,E]},Invisible:{facelets:[ze,ze,ze,ze,ze]},PermuteNonPrimary:{facelets:[ce,H,H,H,H]},Dim:{facelets:[ce,ce,ce,ce,ce]},Ignoriented:{facelets:[ce,E,E,E,E]},OrientationWithoutPermutation:{facelets:[Re,E,E,E,E]},ExperimentalOrientationWithoutPermutation2:{facelets:[hr,E,E,E,E]},Mystery:{facelets:[Ae,Ae,Ae,Ae,Ae]}};function gr(i){return wr[i]}class rn extends le{constructor(e){super(e,"Regular")}set(e,t){for(const[n,r]of this.stickerings.entries())for(let a=0;a<r.length;a++)e.stickerings.get(n)[a]&&(r[a]=t);return this}toStickeringMask(){const e={orbits:{}};for(const[t,n]of this.stickerings.entries()){const r=[],a={pieces:r};e.orbits[t]=a;for(const c of n)r.push(gr(c))}return e}}class an{constructor(e){this.kpuzzle=e}and(e){const t=new le(this.kpuzzle,!1);for(const n of this.kpuzzle.definition.orbits)e:for(let r=0;r<n.numPieces;r++){t.stickerings.get(n.orbitName)[r]=!0;for(const a of e)if(!a.stickerings.get(n.orbitName)[r]){t.stickerings.get(n.orbitName)[r]=!1;continue e}}return t}or(e){const t=new le(this.kpuzzle,!1);for(const n of this.kpuzzle.definition.orbits)e:for(let r=0;r<n.numPieces;r++){t.stickerings.get(n.orbitName)[r]=!1;for(const a of e)if(a.stickerings.get(n.orbitName)[r]){t.stickerings.get(n.orbitName)[r]=!0;continue e}}return t}not(e){const t=new le(this.kpuzzle,!1);for(const n of this.kpuzzle.definition.orbits)for(let r=0;r<n.numPieces;r++)t.stickerings.get(n.orbitName)[r]=!e.stickerings.get(n.orbitName)[r];return t}all(){return this.and(this.moves([]))}move(e){const t=this.kpuzzle.moveToTransformation(e),n=new le(this.kpuzzle,!1);for(const r of this.kpuzzle.definition.orbits)for(let a=0;a<r.numPieces;a++)(t.transformationData[r.orbitName].permutation[a]!==a||t.transformationData[r.orbitName].orientationDelta[a]!==0)&&(n.stickerings.get(r.orbitName)[a]=!0);return n}moves(e){return e.map(t=>this.move(t))}orbits(e){const t=new le(this.kpuzzle,!1);for(const n of e)t.stickerings.get(n).fill(!0);return t}orbitPrefix(e){const t=new le(this.kpuzzle,!1);for(const n of this.kpuzzle.definition.orbits)n.orbitName.startsWith(e)&&t.stickerings.get(n.orbitName).fill(!0);return t}}const Pt="Last Layer",Ut="Last Slot",W={"3x3x3":Pt,megaminx:Pt},te={"3x3x3":Ut,megaminx:Ut},xr={full:{groups:{"3x3x3":"Stickering",megaminx:"Stickering"}},OLL:{groups:W},PLL:{groups:W},LL:{groups:W},EOLL:{groups:W},COLL:{groups:W},OCLL:{groups:W},CPLL:{groups:W},CLL:{groups:W},EPLL:{groups:W},ELL:{groups:W},ZBLL:{groups:W},LS:{groups:te},LSOLL:{groups:te},LSOCLL:{groups:te},ELS:{groups:te},CLS:{groups:te},ZBLS:{groups:te},VLS:{groups:te},WVLS:{groups:te},F2L:{groups:{"3x3x3":"CFOP (Fridrich)"}},Daisy:{groups:{"3x3x3":"CFOP (Fridrich)"}},Cross:{groups:{"3x3x3":"CFOP (Fridrich)"}},EO:{groups:{"3x3x3":"ZZ"}},EOline:{groups:{"3x3x3":"ZZ"}},EOcross:{groups:{"3x3x3":"ZZ"}},FirstBlock:{groups:{"3x3x3":"Roux"}},SecondBlock:{groups:{"3x3x3":"Roux"}},CMLL:{groups:{"3x3x3":"Roux"}},L10P:{groups:{"3x3x3":"Roux"}},L6E:{groups:{"3x3x3":"Roux"}},L6EO:{groups:{"3x3x3":"Roux"}},"2x2x2":{groups:{"3x3x3":"Petrus"}},"2x2x3":{groups:{"3x3x3":"Petrus"}},EODF:{groups:{"3x3x3":"Nautilus"}},G1:{groups:{"3x3x3":"FMC"}},L2C:{groups:{"4x4x4":"Reduction","5x5x5":"Reduction","6x6x6":"Reduction"}},PBL:{groups:{"2x2x2":"Ortega"}},"Void Cube":{groups:{"3x3x3":"Miscellaneous"}},invisible:{groups:{"3x3x3":"Miscellaneous"}},picture:{groups:{"3x3x3":"Miscellaneous"}},"centers-only":{groups:{"3x3x3":"Miscellaneous"}},"experimental-centers-U":{},"experimental-centers-U-D":{},"experimental-centers-U-L-D":{},"experimental-centers-U-L-B-D":{},"experimental-centers":{},"experimental-fto-fc":{groups:{fto:"Bencisco"}},"experimental-fto-f2t":{groups:{fto:"Bencisco"}},"experimental-fto-sc":{groups:{fto:"Bencisco"}},"experimental-fto-l2c":{groups:{fto:"Bencisco"}},"experimental-fto-lbt":{groups:{fto:"Bencisco"}},"experimental-fto-l3t":{groups:{fto:"Bencisco"}}};async function Ce(i,e){return(await yr(i,e)).toStickeringMask()}async function yr(i,e){const t=await i.kpuzzle(),n=new rn(t),r=new an(t),a=()=>r.move("U"),c=()=>r.or(r.moves(["U","D"])),l=()=>r.or(r.moves(["L","R"])),f=()=>r.not(l()),m=()=>r.not(a()),h=()=>r.orbitPrefix("CENTER"),x=it=>r.and([r.move(it),h()]),d=()=>r.orbitPrefix("EDGE"),y=it=>r.and([r.and(r.moves(it)),d()]),w=()=>r.or([r.orbitPrefix("CORNER"),r.orbitPrefix("C4RNER"),r.orbitPrefix("C5RNER")]),R=()=>r.or([f(),r.and([a(),d()])]),q=()=>r.and([a(),h()]),ee=()=>r.and([r.and(r.moves(["F","R"])),d()]),_e=()=>r.and([r.and(r.moves(["F","R"])),w(),r.not(a())]),De=()=>r.or([_e(),ee()]);function b(){n.set(m(),u.Dim)}function Tn(){n.set(a(),u.PermuteNonPrimary),n.set(q(),u.Dim)}function Se(){n.set(a(),u.IgnoreNonPrimary),n.set(q(),u.Regular)}function bt(){n.set(a(),u.Ignoriented),n.set(q(),u.Dim)}switch(e){case"full":break;case"PLL":{b(),Tn();break}case"CLS":{b(),n.set(_e(),u.Regular),n.set(a(),u.Ignoriented),n.set(r.and([a(),h()]),u.Dim),n.set(r.and([a(),w()]),u.IgnoreNonPrimary);break}case"OLL":{b(),Se();break}case"EOLL":{b(),Se(),n.set(r.and([a(),w()]),u.Ignored);break}case"COLL":{b(),n.set(r.and([a(),d()]),u.Ignoriented),n.set(r.and([a(),h()]),u.Dim),n.set(r.and([a(),w()]),u.Regular);break}case"OCLL":{b(),bt(),n.set(r.and([a(),w()]),u.IgnoreNonPrimary);break}case"CPLL":{b(),n.set(r.and([w(),a()]),u.PermuteNonPrimary),n.set(r.and([r.not(w()),a()]),u.Dim);break}case"CLL":{b(),n.set(r.not(r.and([w(),a()])),u.Dim);break}case"EPLL":{b(),n.set(a(),u.Dim),n.set(r.and([a(),d()]),u.PermuteNonPrimary);break}case"ELL":{b(),n.set(a(),u.Dim),n.set(r.and([a(),d()]),u.Regular);break}case"ELS":{b(),Se(),n.set(r.and([a(),w()]),u.Ignored),n.set(ee(),u.Regular),n.set(_e(),u.Ignored);break}case"LL":{b();break}case"F2L":{n.set(a(),u.Ignored);break}case"ZBLL":{b(),n.set(a(),u.PermuteNonPrimary),n.set(q(),u.Dim),n.set(r.and([a(),w()]),u.Regular);break}case"ZBLS":{b(),n.set(De(),u.Regular),Se(),n.set(r.and([a(),w()]),u.Ignored);break}case"VLS":{b(),n.set(De(),u.Regular),Se();break}case"WVLS":{b(),n.set(De(),u.Regular),n.set(r.and([a(),d()]),u.Ignoriented),n.set(r.and([a(),h()]),u.Dim),n.set(r.and([a(),w()]),u.IgnoreNonPrimary);break}case"LS":{b(),n.set(De(),u.Regular),n.set(a(),u.Ignored),n.set(q(),u.Dim);break}case"LSOLL":{b(),Se(),n.set(De(),u.Regular);break}case"LSOCLL":{b(),bt(),n.set(r.and([a(),w()]),u.IgnoreNonPrimary),n.set(De(),u.Regular);break}case"EO":{n.set(w(),u.Ignored),n.set(d(),u.OrientationWithoutPermutation);break}case"EOline":{n.set(w(),u.Ignored),n.set(d(),u.OrientationWithoutPermutation),n.set(r.and(r.moves(["D","M"])),u.Regular);break}case"EOcross":{n.set(d(),u.OrientationWithoutPermutation),n.set(r.move("D"),u.Regular),n.set(w(),u.Ignored);break}case"CMLL":{n.set(m(),u.Dim),n.set(R(),u.Ignored),n.set(r.and([a(),w()]),u.Regular);break}case"L10P":{n.set(r.not(R()),u.Dim),n.set(r.and([w(),a()]),u.Regular);break}case"L6E":{n.set(r.not(R()),u.Dim);break}case"L6EO":{n.set(r.not(R()),u.Dim),n.set(R(),u.ExperimentalOrientationWithoutPermutation2),n.set(r.and([h(),c()]),u.ExperimentalOrientationWithoutPermutation2),n.set(r.and([r.move("M"),r.move("E")]),u.Ignored);break}case"Daisy":{n.set(r.all(),u.Ignored),n.set(h(),u.Dim),n.set(r.and([r.move("D"),h()]),u.Regular),n.set(r.and([r.move("U"),d()]),u.IgnoreNonPrimary);break}case"Cross":{n.set(r.all(),u.Ignored),n.set(h(),u.Dim),n.set(r.and([r.move("D"),h()]),u.Regular),n.set(r.and([r.move("D"),d()]),u.Regular);break}case"2x2x2":{n.set(r.or(r.moves(["U","F","R"])),u.Ignored),n.set(r.and([r.or(r.moves(["U","F","R"])),h()]),u.Dim);break}case"2x2x3":{n.set(r.all(),u.Dim),n.set(r.or(r.moves(["U","F","R"])),u.Ignored),n.set(r.and([r.or(r.moves(["U","F","R"])),h()]),u.Dim),n.set(r.and([r.move("F"),r.not(r.or(r.moves(["U","R"])))]),u.Regular);break}case"G1":{n.set(r.all(),u.ExperimentalOrientationWithoutPermutation2),n.set(r.or(r.moves(["E"])),u.OrientationWithoutPermutation),n.set(r.and(r.moves(["E","S"])),u.Ignored);break}case"L2C":{n.set(r.or(r.moves(["L","R","B","D"])),u.Dim),n.set(r.not(h()),u.Ignored);break}case"PBL":{n.set(r.all(),u.Ignored),n.set(r.or(r.moves(["U","D"])),u.PermuteNonPrimary);break}case"FirstBlock":{n.set(r.not(r.and([r.and(r.moves(["L"])),r.not(a())])),u.Ignored),n.set(x("R"),u.Dim);break}case"SecondBlock":{n.set(r.not(r.and([r.and(r.moves(["L"])),r.not(a())])),u.Ignored),n.set(r.and([r.and(r.moves(["L"])),r.not(a())]),u.Dim),n.set(r.and([r.and(r.moves(["R"])),r.not(a())]),u.Regular);break}case"EODF":{b(),n.set(r.or([_e(),r.and([a(),w()])]),u.Ignored),n.set(r.or([r.and([a(),d()]),ee()]),u.OrientationWithoutPermutation),n.set(y(["D","F"]),u.Regular),n.set(x("F"),u.Regular);break}case"Void Cube":{n.set(h(),u.Invisible);break}case"picture":case"invisible":{n.set(r.all(),u.Invisible);break}case"centers-only":{n.set(r.not(h()),u.Ignored);break}default:console.warn(`Unsupported stickering for ${i.id}: ${e}. Setting all pieces to dim.`),n.set(r.and(r.moves([])),u.Dim)}return n}async function tt(i,e){const t=[],n=[];for(const[r,a]of Object.entries(xr))a.groups&&(i in a.groups?t.push(r):e!=null&&e.use3x3x3Fallbacks&&"3x3x3"in a.groups&&n.push(r));return t.concat(n)}function L(i){let e=null;return()=>e??(e=i())}async function Ft(i){return(await import("./index-9mpLuvhO.js")).getPuzzleGeometryByName(i,{allMoves:!0,orientCenters:!0,addRotations:!0})}async function on(i,e){const t=await i,n=t.getKPuzzleDefinition(!0);n.name=e;const r=await import("./index-9mpLuvhO.js"),a=new r.ExperimentalPGNotation(t,t.getOrbitsDef(!0));return new Z(a.remapKPuzzleDefinition(n),{experimentalPGNotation:a})}var Xe,je,et;class ge{constructor(e){v(this,"pgId");v(this,"id");v(this,"fullName");v(this,"inventedBy");v(this,"inventionYear");S(this,Xe);S(this,je);S(this,et);v(this,"puzzleSpecificSimplifyOptionsPromise",Dr(this.kpuzzle.bind(this)));this.pgId=e.pgID,this.id=e.id,this.fullName=e.fullName,this.inventedBy=e.inventedBy,this.inventionYear=e.inventionYear}pg(){return s(this,Xe)??D(this,Xe,Ft(this.pgId??this.id))}kpuzzle(){return s(this,je)??D(this,je,on(this.pg(),this.id))}svg(){return s(this,et)??D(this,et,(async()=>(await this.pg()).generatesvg())())}}Xe=new WeakMap,je=new WeakMap,et=new WeakMap;class Te extends ge{constructor(){super(...arguments);v(this,"stickerings",()=>tt(this.id,{use3x3x3Fallbacks:!0}))}stickeringMask(t){return Ce(this,t)}}function Dr(i){return new Fe(async e=>{const t=await i();e({quantumMoveOrder:n=>t.moveToTransformation(new o(n)).repetitionOrder()})})}const Lt={id:"2x2x2",fullName:"2×2×2 Cube",kpuzzle:L(async()=>new Z((await import("./puzzles-dynamic-side-events-er4iZI0M.js")).cube2x2x2JSON)),svg:async()=>(await import("./puzzles-dynamic-side-events-er4iZI0M.js")).cube2x2x2SVG,llSVG:L(async()=>(await import("./puzzles-dynamic-side-events-er4iZI0M.js")).cube2x2x2LLSVG),pg:L(async()=>Ft("2x2x2")),stickeringMask:i=>Ce(Lt,i),stickerings:()=>tt("2x2x2",{use3x3x3Fallbacks:!0})},sn={name:"3x3x3",orbits:[{orbitName:"EDGES",numPieces:12,numOrientations:2},{orbitName:"CORNERS",numPieces:8,numOrientations:3},{orbitName:"CENTERS",numPieces:6,numOrientations:4}],defaultPattern:{EDGES:{pieces:[0,1,2,3,4,5,6,7,8,9,10,11],orientation:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{pieces:[0,1,2,3,4,5,6,7],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{pieces:[0,1,2,3,4,5],orientation:[0,0,0,0,0,0],orientationMod:[1,1,1,1,1,1]}},moves:{U:{EDGES:{permutation:[1,2,3,0,4,5,6,7,8,9,10,11],orientationDelta:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[1,2,3,0,4,5,6,7],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientationDelta:[1,0,0,0,0,0]}},y:{EDGES:{permutation:[1,2,3,0,5,6,7,4,10,8,11,9],orientationDelta:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[1,2,3,0,7,4,5,6],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,2,3,4,1,5],orientationDelta:[1,0,0,0,0,3]}},x:{EDGES:{permutation:[4,8,0,9,6,10,2,11,5,7,1,3],orientationDelta:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[4,0,3,5,7,6,2,1],orientationDelta:[2,1,2,1,1,2,1,2]},CENTERS:{permutation:[2,1,5,3,0,4],orientationDelta:[0,3,0,1,2,2]}},L:{EDGES:{permutation:[0,1,2,11,4,5,6,9,8,3,10,7],orientationDelta:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[0,1,6,2,4,3,5,7],orientationDelta:[0,0,2,1,0,2,1,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientationDelta:[0,1,0,0,0,0]}},F:{EDGES:{permutation:[9,1,2,3,8,5,6,7,0,4,10,11],orientationDelta:[1,0,0,0,1,0,0,0,1,1,0,0]},CORNERS:{permutation:[3,1,2,5,0,4,6,7],orientationDelta:[1,0,0,2,2,1,0,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientationDelta:[0,0,1,0,0,0]}},R:{EDGES:{permutation:[0,8,2,3,4,10,6,7,5,9,1,11],orientationDelta:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[4,0,2,3,7,5,6,1],orientationDelta:[2,1,0,0,1,0,0,2]},CENTERS:{permutation:[0,1,2,3,4,5],orientationDelta:[0,0,0,1,0,0]}},B:{EDGES:{permutation:[0,1,10,3,4,5,11,7,8,9,6,2],orientationDelta:[0,0,1,0,0,0,1,0,0,0,1,1]},CORNERS:{permutation:[0,7,1,3,4,5,2,6],orientationDelta:[0,2,1,0,0,0,2,1]},CENTERS:{permutation:[0,1,2,3,4,5],orientationDelta:[0,0,0,0,1,0]}},D:{EDGES:{permutation:[0,1,2,3,7,4,5,6,8,9,10,11],orientationDelta:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[0,1,2,3,5,6,7,4],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientationDelta:[0,0,0,0,0,1]}},z:{EDGES:{permutation:[9,3,11,7,8,1,10,5,0,4,2,6],orientationDelta:[1,1,1,1,1,1,1,1,1,1,1,1]},CORNERS:{permutation:[3,2,6,5,0,4,7,1],orientationDelta:[1,2,1,2,2,1,2,1]},CENTERS:{permutation:[1,5,2,0,4,3],orientationDelta:[1,1,1,1,3,1]}},M:{EDGES:{permutation:[2,1,6,3,0,5,4,7,8,9,10,11],orientationDelta:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[0,1,2,3,4,5,6,7],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[4,1,0,3,5,2],orientationDelta:[2,0,0,0,2,0]}},E:{EDGES:{permutation:[0,1,2,3,4,5,6,7,9,11,8,10],orientationDelta:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[0,1,2,3,4,5,6,7],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,4,1,2,3,5],orientationDelta:[0,0,0,0,0,0]}},S:{EDGES:{permutation:[0,3,2,7,4,1,6,5,8,9,10,11],orientationDelta:[0,1,0,1,0,1,0,1,0,0,0,0]},CORNERS:{permutation:[0,1,2,3,4,5,6,7],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[1,5,2,0,4,3],orientationDelta:[1,1,0,1,0,1]}},u:{EDGES:{permutation:[1,2,3,0,4,5,6,7,10,8,11,9],orientationDelta:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[1,2,3,0,4,5,6,7],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,2,3,4,1,5],orientationDelta:[1,0,0,0,0,0]}},l:{EDGES:{permutation:[2,1,6,11,0,5,4,9,8,3,10,7],orientationDelta:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[0,1,6,2,4,3,5,7],orientationDelta:[0,0,2,1,0,2,1,0]},CENTERS:{permutation:[4,1,0,3,5,2],orientationDelta:[2,1,0,0,2,0]}},f:{EDGES:{permutation:[9,3,2,7,8,1,6,5,0,4,10,11],orientationDelta:[1,1,0,1,1,1,0,1,1,1,0,0]},CORNERS:{permutation:[3,1,2,5,0,4,6,7],orientationDelta:[1,0,0,2,2,1,0,0]},CENTERS:{permutation:[1,5,2,0,4,3],orientationDelta:[1,1,1,1,0,1]}},r:{EDGES:{permutation:[4,8,0,3,6,10,2,7,5,9,1,11],orientationDelta:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[4,0,2,3,7,5,6,1],orientationDelta:[2,1,0,0,1,0,0,2]},CENTERS:{permutation:[2,1,5,3,0,4],orientationDelta:[0,0,0,1,2,2]}},b:{EDGES:{permutation:[0,5,10,1,4,7,11,3,8,9,6,2],orientationDelta:[0,1,1,1,0,1,1,1,0,0,1,1]},CORNERS:{permutation:[0,7,1,3,4,5,2,6],orientationDelta:[0,2,1,0,0,0,2,1]},CENTERS:{permutation:[3,0,2,5,4,1],orientationDelta:[3,3,0,3,1,3]}},d:{EDGES:{permutation:[0,1,2,3,7,4,5,6,9,11,8,10],orientationDelta:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[0,1,2,3,5,6,7,4],orientationDelta:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,4,1,2,3,5],orientationDelta:[0,0,0,0,0,1]}}},derivedMoves:{Uw:"u",Lw:"l",Fw:"f",Rw:"r",Bw:"b",Dw:"d",Uv:"y",Lv:"x'",Fv:"z",Rv:"x",Bv:"z'",Dv:"y'","2U":"u U'","2L":"l L'","2F":"f F'","2R":"r R'","2B":"b B'","2D":"d D'"}};function un(i){const e=i.patternData.CENTERS.pieces[0],t=i.patternData.CENTERS.pieces[5],n=i.patternData.CENTERS.pieces[1];let r=n;return e<n&&r--,t<n&&r--,[e,r]}const It=new Array(6).fill(0).map(()=>new Array(6));function Sr(){{const i=["","z","x","z'","x'","x2"].map(t=>p.fromString(t)),e=new p("y");for(const t of i){let n=ln.algToTransformation(t);for(let r=0;r<4;r++){n=n.applyAlg(e);const[a,c]=un(n.toKPattern());It[a][c]=n.invert()}}}return It}function Rr(i){const[e,t]=un(i),n=Sr()[e][t];return i.applyTransformation(n)}function vr(i,e){var t;return e.ignorePuzzleOrientation&&(i=Rr(i)),e.ignoreCenterOrientation&&(i=new T(i.kpuzzle,{EDGES:i.patternData.EDGES,CORNERS:i.patternData.CORNERS,CENTERS:{pieces:i.patternData.CENTERS.pieces,orientation:new Array(6).fill(0)}})),!!((t=i.experimentalToTransformation())!=null&&t.isIdentityTransformation())}new Array(24);async function cn(i,e){return(await import("./index-9mpLuvhO.js")).getPuzzleGeometryByDesc(i,{allMoves:!0,orientCenters:!0,addRotations:!0,...e})}async function Fr(i,e){const t=cn(i,e);return on(t,`description: ${i}`)}const ln=new Z(sn);sn.experimentalIsPatternSolved=vr;const Lr={KeyI:new o("R"),KeyK:new o("R'"),KeyW:new o("B"),KeyO:new o("B'"),KeyS:new o("D"),KeyL:new o("D'"),KeyD:new o("L"),KeyE:new o("L'"),KeyJ:new o("U"),KeyF:new o("U'"),KeyH:new o("F"),KeyG:new o("F'"),KeyC:new o("l"),KeyR:new o("l'"),KeyU:new o("r"),KeyM:new o("r'"),KeyX:new o("d"),Comma:new o("d'"),KeyT:new o("x"),KeyY:new o("x"),KeyV:new o("x'"),KeyN:new o("x'"),Semicolon:new o("y"),KeyA:new o("y'"),KeyP:new o("z"),KeyQ:new o("z'"),KeyZ:new o("M'"),KeyB:new o("M"),Period:new o("M'"),Backquote:new P};function N(i,e,t,n){const r=[];for(const a of i){const c=o.fromString(a),{family:l,amount:f}=c;if(![-1,1].includes(f))throw new Error("Invalid config move");r.push({family:l,direction:f,type:e,from:t,to:n})}return r}const ye={"x axis":{sliceDiameter:3,extendsThroughEntirePuzzle:!0,moveSourceInfos:[...N(["R"],0,0,3),...N(["L'"],1,0,3),...N(["r","Rw"],2,0,2),...N(["l'","Lw'"],3,0,2),...N(["M'"],4,1,2),...N(["x","Uv","Dv'"],5,0,3)]},"y axis":{sliceDiameter:3,extendsThroughEntirePuzzle:!0,moveSourceInfos:[...N(["U"],0,0,3),...N(["D'"],1,0,3),...N(["u","Uw"],2,0,2),...N(["d'","Dw'"],3,0,2),...N(["E'"],4,1,2),...N(["y","Uv","Dv'"],5,0,3)]},"z axis":{sliceDiameter:3,extendsThroughEntirePuzzle:!0,moveSourceInfos:[...N(["F"],0,0,3),...N(["B'"],1,0,3),...N(["f","Fw"],2,0,3),...N(["b'","Bw'"],3,0,3),...N(["S"],4,1,2),...N(["z","Fv","Bv'"],5,0,3)]}},Me={};for(const[i,e]of Object.entries(ye))for(const t of e.moveSourceInfos)Me[t.family]={axis:i,moveSourceInfo:t};const mn={};var Ht;for(const i of Object.keys(ye)){const e={};mn[i]=e;for(const t of ye[i].moveSourceInfos)(e[Ht=t.type]??(e[Ht]=[])).push(t)}const fn={};for(const i of Object.keys(ye)){const e=new Map;fn[i]=e;for(const t of ye[i].moveSourceInfos)e.get(t.from)||e.set(t.from,t)}function Ot(i,e){var n;const t=(n=mn[i][e])==null?void 0:n[0];if(!t)throw new Error(`Could not find a reference move (axis: ${i}, move source type: ${e})`);return t}const Er=(i,e)=>Me[i.family].axis===Me[e.family].axis;function br(i,e,t,n){if(e+1===t){const d=fn[i].get(e);if(d)return new o(new Q(d.family),n*d.direction)}const r=ye[i],{sliceDiameter:a}=r;if(e===0&&t===a){const d=Ot(i,5);return new o(new Q(d.family),n*d.direction)}const c=e+t>a;c&&([e,t]=[a-t,a-e]);let l=e+1,f=t;const m=l===f;m&&(f=null),l===1&&(l=null),m&&l===1&&(f=null),!m&&f===2&&(f=null);const x=Ot(i,m?c?1:0:c?3:2);return new o(new Q(x.family,f,l),n*x.direction)}function Br(i,e=!0){if(i.length===0)return[];const t=Me[i[0].family].axis,n=ye[t],{sliceDiameter:r}=n,a=new Map;let c=null;function l(d,y){let w=(a.get(d)??0)+y;e&&(w=w%4+5%4-1),w===0?a.delete(d):a.set(d,w)}let f=0;for(const d of Array.from(i).reverse()){f++;const{moveSourceInfo:y}=Me[d.family],w=d.amount*y.direction;switch(y.type){case 0:{const R=(d.innerLayer??1)-1;l(R,w),l(R+1,-w);break}case 1:{const R=r-(d.innerLayer??1);l(R,w),l(R+1,-w);break}case 2:{l((d.outerLayer??1)-1,w),l(d.innerLayer??2,-w);break}case 3:{l(r-(d.innerLayer??2),w),l(r-((d.outerLayer??1)-1),-w);break}case 4:{l(y.from,w),l(y.to,-w);break}case 5:{l(0,w),l(r,-w);break}}[0,2].includes(a.size)&&(c={suffixLength:f,sliceDeltas:new Map(a)})}if(a.size===0)return[];if(!c)return i;let[m,h]=c.sliceDeltas.keys();m>h&&([m,h]=[h,m]);const x=c.sliceDeltas.get(m);return[...i.slice(0,-c.suffixLength),...x!==0?[br(t,m,h,x)]:[]]}const Nr={quantumMoveOrder:()=>4,axis:{areQuantumMovesSameAxis:Er,simplifySameAxisMoves:Br}},dn={id:"3x3x3",fullName:"3×3×3 Cube",inventedBy:["Ernő Rubik"],inventionYear:1974,kpuzzle:L(async()=>ln),svg:L(async()=>(await import("./puzzles-dynamic-3x3x3-BW0FSrXs.js")).cube3x3x3SVG),llSVG:L(async()=>(await import("./puzzles-dynamic-3x3x3-BW0FSrXs.js")).cube3x3x3LLSVG),llFaceSVG:L(async()=>(await import("./puzzles-dynamic-3x3x3-BW0FSrXs.js")).cube3x3x3LLFaceSVG),pg:L(async()=>Ft("3x3x3")),stickeringMask:i=>Ce(dn,i),stickerings:()=>tt("3x3x3"),puzzleSpecificSimplifyOptions:Nr,keyMapping:async()=>Lr},pn=new Te({id:"4x4x4",fullName:"4×4×4 Cube"});pn.llSVG=L(async()=>(await import("./puzzles-dynamic-4x4x4-CsNOCKFJ.js")).cube4x4x4LLSVG);const zr={id:"clock",fullName:"Clock",inventedBy:["Christopher C. Wiggs","Christopher J. Taylor"],inventionYear:1988,kpuzzle:L(async()=>new Z((await import("./puzzles-dynamic-side-events-er4iZI0M.js")).clockJSON)),svg:L(async()=>(await import("./puzzles-dynamic-side-events-er4iZI0M.js")).clockSVG)};async function Ar(i,e){const t=await i.kpuzzle(),n=new rn(t),r=new an(t),a=()=>r.and([r.move("U"),r.not(r.or(r.moves(["F","BL","BR"])))]),c=()=>r.and([r.move("U"),r.not(r.move("F"))]),l=()=>r.or([c(),r.and([r.move("F"),r.not(r.or(r.moves(["U","BL","BR"])))])]),f=()=>r.not(r.or([r.and([r.move("U"),r.move("F")]),r.and([r.move("F"),r.move("BL")]),r.and([r.move("F"),r.move("BR")]),r.and([r.move("BL"),r.move("BR")])])),m=()=>r.not(r.or([r.and([r.move("F"),r.move("BL")]),r.and([r.move("F"),r.move("BR")]),r.and([r.move("BL"),r.move("BR")])]));switch(e){case"full":break;case"experimental-fto-fc":{n.set(r.not(a()),u.Ignored);break}case"experimental-fto-f2t":{n.set(r.not(c()),u.Ignored),n.set(a(),u.Dim);break}case"experimental-fto-sc":{n.set(r.not(l()),u.Ignored),n.set(c(),u.Dim);break}case"experimental-fto-l2c":{n.set(r.not(f()),u.Ignored),n.set(l(),u.Dim);break}case"experimental-fto-lbt":{n.set(r.not(m()),u.Ignored),n.set(f(),u.Dim);break}case"experimental-fto-l3t":{n.set(m(),u.Dim);break}default:console.warn(`Unsupported stickering for ${i.id}: ${e}. Setting all pieces to dim.`),n.set(r.and(r.moves([])),u.Dim)}return n.toStickeringMask()}async function kr(){return["full","experimental-fto-fc","experimental-fto-f2t","experimental-fto-sc","experimental-fto-l2c","experimental-fto-lbt","experimental-fto-l3t"]}const Tr={KeyI:new o("R"),KeyK:new o("R'"),KeyW:new o("B"),KeyO:new o("B'"),KeyS:new o("D"),KeyL:new o("D'"),KeyD:new o("L"),KeyE:new o("L'"),KeyJ:new o("U"),KeyF:new o("U'"),KeyH:new o("F"),KeyG:new o("F'"),KeyN:new o("Rv'"),KeyC:new o("l"),KeyR:new o("l'"),KeyU:new o("r"),KeyM:new o("r'"),KeyX:new o("d"),Comma:new o("d'"),KeyT:new o("Lv'"),KeyY:new o("Rv"),KeyV:new o("Lv"),Semicolon:new o("Uv"),KeyA:new o("Uv'"),KeyP:new o("BR'"),KeyQ:new o("BL"),KeyZ:new o("BL'"),KeyB:new o("T"),Period:new o("BR"),Backquote:new P};class Pr extends ge{constructor(){super({pgID:"FTO",id:"fto",fullName:"Face-Turning Octahedron",inventedBy:["Karl Rohrbach","David Pitcher"],inventionYear:1983});v(this,"stickerings",kr);v(this,"svg",L(async()=>(await import("./puzzles-dynamic-unofficial-AafI5of3.js")).ftoSVG));v(this,"keyMapping",async()=>Tr)}stickeringMask(t){return Ar(this,t)}}const Ur=new Pr,Ct="d f 0.56",Ir={id:"kilominx",fullName:"Kilominx",kpuzzle:L(()=>Fr(Ct,{includeCenterOrbits:!1,includeEdgeOrbits:!1})),pg:()=>cn(Ct,{includeCenterOrbits:!1,includeEdgeOrbits:!1}),svg:L(async()=>(await import("./puzzles-dynamic-unofficial-AafI5of3.js")).kilominxSVG)},Or={id:"loopover",fullName:"Loopover",inventedBy:["Cary Huang"],inventionYear:2018,kpuzzle:L(async()=>new Z((await import("./puzzles-dynamic-unofficial-AafI5of3.js")).loopoverJSON)),svg:async()=>(await import("./puzzles-dynamic-unofficial-AafI5of3.js")).loopoverSVG};async function Cr(i,e){return(await hn()).includes(e)?Ce(i,e):(console.warn(`Unsupported stickering for ${i.id}: ${e}. Setting all pieces to dim.`),Ce(i,"full"))}const Mr=V(()=>tt("megaminx"));function hn(){return Mr}const Kr={KeyI:new o("R"),KeyK:new o("R'"),KeyW:new o("B"),KeyO:new o("B'"),KeyS:new o("FR"),KeyL:new o("FR'"),KeyD:new o("L"),KeyE:new o("L'"),KeyJ:new o("U"),KeyF:new o("U'"),KeyH:new o("F"),KeyG:new o("F'"),KeyC:new o("Lw"),KeyR:new o("Lw'"),KeyU:new o("Rw"),KeyM:new o("Rw'"),KeyX:new o("d"),Comma:new o("d'"),KeyT:new o("Rv"),KeyY:new o("Rv"),KeyV:new o("Rv'"),KeyN:new o("Rv'"),Semicolon:new o("y"),KeyA:new o("y'"),KeyP:new o("z"),KeyQ:new o("z'"),KeyZ:new o("2L'"),KeyB:new o("2R"),Period:new o("2R'"),Backquote:new P};class Gr extends ge{constructor(){super({id:"megaminx",fullName:"Megaminx",inventionYear:1981});v(this,"stickerings",hn);v(this,"llSVG",L(async()=>(await import("./puzzles-dynamic-megaminx-pDLrtc2V.js")).megaminxLLSVG));v(this,"keyMapping",async()=>Kr)}stickeringMask(t){return Cr(this,t)}}const _r=new Gr,qr={id:"melindas2x2x2x2",fullName:"Melinda's 2×2×2×2",inventedBy:["Melinda Green"],kpuzzle:L(async()=>new Z((await import("./puzzles-dynamic-side-events-er4iZI0M.js")).melindas2x2x2x2OrbitJSON)),svg:L(async()=>(await import("./puzzles-dynamic-side-events-er4iZI0M.js")).melindas2x2x2x2OrbitSVG)};class $r extends ge{constructor(){super({id:"pyraminx",fullName:"Pyraminx",inventedBy:["Uwe Meffert"]});v(this,"svg",L(async()=>(await import("./puzzles-dynamic-side-events-er4iZI0M.js")).pyraminxSVG))}}const Wr=new $r,Qr={id:"redi_cube",fullName:"Redi Cube",inventedBy:["Oskar van Deventer"],inventionYear:2009,kpuzzle:L(async()=>new Z((await import("./puzzles-dynamic-unofficial-AafI5of3.js")).rediCubeJSON)),svg:async()=>(await import("./puzzles-dynamic-unofficial-AafI5of3.js")).rediCubeSVG},Vr={id:"square1",fullName:"Square-1",inventedBy:["Karel Hršel","Vojtech Kopský"],inventionYear:1990,kpuzzle:L(async()=>new Z((await import("./puzzles-dynamic-side-events-er4iZI0M.js")).sq1HyperOrbitJSON)),svg:L(async()=>(await import("./puzzles-dynamic-side-events-er4iZI0M.js")).sq1HyperOrbitSVG)},Hr={id:"tri_quad",fullName:"TriQuad",inventedBy:["Bram Cohen","Carl Hoff"],inventionYear:2018,kpuzzle:L(async()=>new Z((await import("./puzzles-dynamic-side-events-er4iZI0M.js")).triQuadJSON)),svg:L(async()=>(await import("./puzzles-dynamic-side-events-er4iZI0M.js")).triQuadSVG)},re={"3x3x3":dn,"2x2x2":Lt,"4x4x4":pn,"5x5x5":new Te({id:"5x5x5",fullName:"5×5×5 Cube"}),"6x6x6":new Te({id:"6x6x6",fullName:"6×6×6 Cube"}),"7x7x7":new Te({id:"7x7x7",fullName:"7×7×7 Cube"}),"40x40x40":new Te({id:"40x40x40",fullName:"40×40×40 Cube"}),clock:zr,megaminx:_r,pyraminx:Wr,skewb:new ge({id:"skewb",fullName:"Skewb",inventedBy:["Tony Durham"]}),square1:Vr,fto:Ur,gigaminx:new ge({id:"gigaminx",fullName:"Gigaminx",inventedBy:["Tyler Fox"],inventionYear:2006}),master_tetraminx:new ge({pgID:"master tetraminx",id:"master_tetraminx",fullName:"Master Tetraminx",inventedBy:["Katsuhiko Okamoto"],inventionYear:2002}),kilominx:Ir,redi_cube:Qr,melindas2x2x2x2:qr,loopover:Or,tri_quad:Hr};let wn=!1;function Zr(i){wn=i}function J(){if(!wn)throw new Error("Must be called from inside a worker, to avoid impact on page performance. Try importing from the top level of `cubing/solve`?")}var gn=2**53,Jr=2097152,Yr=11,ut=new Uint32Array(2);function Xr(){globalThis.crypto.getRandomValues(ut);const i=ut[0],e=ut[1];return Math.floor(i*Jr)+(e>>Yr)}function jr(i){if(typeof i!="number"||i<0||Math.floor(i)!==i)throw new Error("randomUIntBelow() not called with a positive integer value.");if(i>gn)throw new Error(`Called randomUIntBelow() with max === ${i}, which is larger than JavaScript can handle with integer precision.`)}function ei(i){jr(i);for(var e,t,n;;)if(e=Xr(),t=Math.floor(e/i),n=t*i,n<=gn-i)return e-n}function xn(i){return i[ei(i.length)]}var ve=(i=>(i.OuterBlockTurnMetric="OBTM",i.RangeBlockTurnMetric="RBTM",i.SingleSliceTurnMetric="SSTM",i.OuterBlockQuantumTurnMetric="OBQTM",i.RangeBlockQuantumTurnMetric="RBQTM",i.SingleSliceQuantumTurnMetric="SSQTM",i.ExecutionTurnMetric="ETM",i))(ve||{});ve.OuterBlockTurnMetric+"",ve.RangeBlockTurnMetric+"",ve.OuterBlockQuantumTurnMetric+"",ve.RangeBlockQuantumTurnMetric+"",ve.ExecutionTurnMetric+"";class nt extends vt{constructor(e){super(),this.metric=e}traverseAlg(e){let t=0;for(const n of e.childAlgNodes())t+=this.traverseAlgNode(n);return t}traverseGrouping(e){const t=e.alg;return this.traverseAlg(t)*Math.abs(e.amount)}traverseMove(e){return this.metric(e)}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 0}traverseNewline(e){return 0}traverseLineComment(e){return 0}}class ti extends vt{traverseAlg(e){let t=0;for(const n of e.childAlgNodes())t+=this.traverseAlgNode(n);return t}traverseGrouping(e){const t=e.alg;return this.traverseAlg(t)*Math.abs(e.amount)}traverseMove(e){return 1}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 1}traverseNewline(e){return 1}traverseLineComment(e){return 1}}function yn(i){return"A"<=i&&i<="Z"}function Dn(i){const e=i.family;return yn(e[0])&&e[e.length-1]==="v"||e==="x"||e==="y"||e==="z"||e==="T"?0:1}function ni(i){return 1}function Sn(i){const e=i.family;return yn(e[0])&&e[e.length-1]==="v"||e==="x"||e==="y"||e==="z"||e==="T"?0:1}function ri(i){return Math.abs(i.amount)*Sn(i)}const ii=ue(nt,[Dn]);ue(nt,[ni]);ue(nt,[ri]);ue(nt,[Sn]);ue(ti,[Dn]);class ai extends vt{traverseAlg(e){let t=0;for(const n of e.childAlgNodes())t+=this.traverseAlgNode(n);return t}traverseGrouping(e){return this.traverseAlg(e.alg)*Math.abs(e.amount)}traverseMove(e){return 1}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 1}traverseNewline(e){return 0}traverseLineComment(e){return 0}}ue(ai);const oi=2;function si(i,e){const t=[];for(const n of e){const r=new o(n);if(r.amount!==1)throw new Error("SGS cannot handle def moves with an amount other than 1 yet.");let a=i.identityTransformation();for(let c=1;a=a.applyMove(r),!a.isIdentityTransformation();c++)t.push({move:r.modified({amount:c}),transformation:a})}return t}class rt{constructor(e,t,n){v(this,"searchMoves");this.kpuzzle=e,this.sgs=t,this.searchMoves=si(this.kpuzzle,n??Object.keys(this.kpuzzle.definition.moves))}async solve(e,t=oi,n){const r=e.experimentalToTransformation();if(!r)throw new Error("distinguishable pieces are not supported in tremble solver yt");let a=null,c=1e6;const l=(f,m,h)=>{if(m===0){const x=this.sgsPhaseSolve(f,c);if(!x)return;const d=h.concat(x).experimentalSimplify({cancel:{directional:"any-direction",puzzleSpecificModWrap:"canonical-centered"},puzzleSpecificSimplifyOptions:{quantumMoveOrder:n}}),y=ii(d);(a===null||y<c)&&(a=d,c=y);return}for(const x of this.searchMoves)l(f.applyTransformation(x.transformation),m-1,h.concat([x.move]))};for(let f=0;f<=t;f++)l(r,f,new p);if(a===null)throw new Error("SGS search failed.");return a}sgsPhaseSolve(e,t){const n=new Dt;let r=e;for(const a of this.sgs.ordering){const c=a.pieceOrdering;let l="";const f=r.invert();for(let h=0;h<c.length;h++){const x=c[h],d=x.orbitName,y=x.permutationIdx;l+=` ${f.transformationData[d].permutation[y]} ${f.transformationData[d].orientationDelta[y]}`}const m=a.lookup[l];if(!m)throw new Error("Missing algorithm in sgs or esgs?");if(n.experimentalPushAlg(m.alg),n.experimentalNumAlgNodes()>=t)return null;r=r.applyTransformation(m.transformation);for(let h=0;h<c.length;h++){const x=c[h],d=x.orbitName,y=x.permutationIdx;if(r.transformationData[d].permutation[y]!==y||r.transformationData[d].orientationDelta[y]!==0)throw new Error("bad SGS :-(")}}return n.toAlg()}}const Rn=V(async()=>import("./index-DKBrHsC6.js"));async function vn(i,e,t){const{wasmTwsearch:n}=await Rn;return n(i,e,t)}async function ui(i){const{wasmRandomScrambleForEvent:e}=await Rn;return e(i)}const oe=V(()=>import("./search-dynamic-sgs-side-events-B78__AKm.js"));let Mt=null;async function ci(){return Mt||(Mt=(async()=>{const i=await(await oe).cachedData222();return new rt(await re["2x2x2"].kpuzzle(),i,"URFLBD".split(""))})())}async function li(){await ci()}async function mi(i){return J(),vn((await Lt.kpuzzle()).definition,i,{generatorMoves:"UFLR".split("")})}function Fn(i,e){const t=new Dt;t.experimentalPushAlg(i);for(const n of e){const r=xn(n);r!==null&&t.push(o.fromString(r))}return t.toAlg()}const Ln=V(()=>import("./search-dynamic-solve-3x3x3-4o6GMjr8.js")),fi="UF UR UB UL DF DR DB DL FR FL BR BL".split(" "),di="UFR URB UBL ULF DRF DFL DLB DBR".split(" "),pi="U L F R B D".split(" "),hi=[[1,2,0],[0,2,0],[1,1,0],[0,3,0],[2,0,0],[0,1,0],[1,3,0],[0,0,0],[1,0,0],[1,0,2],[0,1,1],[1,1,1],[0,8,1],[2,3,0],[0,10,1],[1,4,1],[0,5,1],[1,7,2],[1,3,2],[0,0,1],[1,0,1],[0,9,0],[2,2,0],[0,8,0],[1,5,1],[0,4,1],[1,4,2],[1,5,0],[0,4,0],[1,4,0],[0,7,0],[2,5,0],[0,5,0],[1,6,0],[0,6,0],[1,7,0],[1,2,2],[0,3,1],[1,3,1],[0,11,1],[2,1,0],[0,9,1],[1,6,1],[0,7,1],[1,5,2],[1,1,2],[0,2,1],[1,2,1],[0,10,0],[2,4,0],[0,11,0],[1,7,1],[0,6,1],[1,6,2]];function Kt(i,e){return i.slice(e)+i.slice(0,e)}function wi(i){const e=[[],[]];for(let t=0;t<6;t++)if(i.patternData.CENTERS.pieces[t]!==t)throw new Error("non-oriented puzzles are not supported");for(let t=0;t<12;t++)e[0].push(Kt(fi[i.patternData.EDGES.pieces[t]],i.patternData.EDGES.orientation[t]));for(let t=0;t<8;t++)e[1].push(Kt(di[i.patternData.CORNERS.pieces[t]],i.patternData.CORNERS.orientation[t]));return e.push(pi),e}function gi(i){const e=wi(i);return hi.map(([t,n,r])=>e[t][n][r]).join("")}function Gt(i,e){const t=new T(i.kpuzzle,{EDGES:i.patternData.EDGES,CORNERS:i.patternData.CORNERS,CENTERS:{pieces:i.patternData.CENTERS.pieces,orientation:new Array(6).fill(0)}}).experimentalToTransformation(),n=new T(e.kpuzzle,{EDGES:e.patternData.EDGES,CORNERS:e.patternData.CORNERS,CENTERS:{pieces:e.patternData.CENTERS.pieces,orientation:new Array(6).fill(0)}}).experimentalToTransformation();return t.isIdentical(n)}function xi(i,e){if(Gt(i.defaultPattern(),e))return!1;for(const t of"ULFRBD")for(let n=1;n<4;n++){const r=i.moveToTransformation(new o(t,n)).toKPattern();if(Gt(r,e))return!1}return!0}const yi=[["R U'","R2 B","D2 B2","D' L B'","R' U'","B","D B2","R' B","L' U","L2 B'","B2","D L B'","L U","B'","U'","R B","D' B2","L B'","U2","U L' B'","","U' L' B'","U","L' B'"],["F2 L2","F' L'","R' F L2","D' L2","F L2","F2 L'","R' F' L'","R2 F L2","R2 F2 L'","L2","F L'","D' L","D2 L2","R2 F' L'","D L","","L2 F L'","L F' L2","L F L'","F' L2","L'","D L2","D F L'","L"],["R B U2 B'","R2 B U' B'","F2 B U B'","F B2 L' B2","B2 L B2","B U' B'","R2 B U2 B'","R' B U' B'","B2 L' B2","F B U B'","B2 U' B2","B' L B","L F' B D' B'","B' U' B2 D B'","B U2 B'","R B U' B'","B2 L2 B2","D' B' L B","B U B'","F' B2 L' B2","","B2 L' B' U' B'"],["U F2 L2 U'","F' U L' U'","F2 U L' U'","U F L2 U'","U2 B2 U2","R' U' B U","D2 U L U'","D U2 B' U2","U L2 U'","F U L' U'","D U L U'","U2 B' U2","","U2 B' U' L' U'","U2 L' U2","U' B U","U L U'","D' U2 B' U2","U L' U'","U2 B U2"],["R' D' F2","F'","F2","D R F'","R D' F2","R2 F'","D' F2","R F'","F2 R' D' F2","F","D2 F2","D' R F'","R2 D' F2","R' F'","D F2","D2 R F'","","F R' D' F2"],["R' D2 F' D F","R F2 R2 F2","R2 F' D2 F","F' R2 D2 F","L D' L'","D F' D2 F","F2 R2 F2","R F' D2 F","F' R2 D' F","F' R' D2 F","F2 R' F2","L D L'","F' R D' F","F2 R F2","F' D2 F","","L D2 R D' L'","F' D2 F' R F2","D2 R2 F2 R2 F2","D F' D' F","F' D F"],["U F2 U'","R U F' U'","D R U F2 U'","U F U'","R2 U F2 U'","R' U F' U'","R U F2 U'","R2 U F' U'","","U L D L' F U'","F2 D' R D F2","D2 U F U'","R' U F2 U'","U F' U'","F2 D2 R D2 F2","D U F U'"],["R2","R' B' D B","D R'","F' R2 F","","R B' D B","R'","B' D B","D' R'","D2 F' R2 F","R","R2 B' D B","D2 R'","B' D' B"],["R2 D' R2","F' R' F R","R D' R2 D R'","D2 R2 D2 R2","R' D' F' R F","U F D F' U'","","R2 D2 B R' B' R'","R' F D' F2 R F","R2 D R2","F2 U F U' F","R' D F' R F","D R2 D2 R2","U F D' F' U'","D R' D2 F' R F","R2 D2 R2","U F D2 F' U'","R' D2 F' R F"],["B R B'","F D F' B R2 B'","D B R2 B'","D2 B R' B'","B R2 B'","D B R' B'","D' B R2 B'","B R' B'","","B R2 B' D B R' B'","D2 B R2 B'","D' B R' B'"],["","R' D R F D2 F'","R' D R","D F D' F'","R F' R' F","F D' F'","R' D' R","F D2 F'","R' D2 R","F D F'"],["","F2 D2 R F' R' D2 F' D2 F'","F2 D2 F' D' F D' F' D2 F'","F2 D F2 D F2 D2 F2","D2 F L D2 L' D2 F'","D F D2 L D2 L' F'","R' D B' D2 B D' R","R' D2 B' D2 B R","F D2 F' D F D F'","F D' L D2 L' D F'","B D' F D B' D' F'","F D2 L D2 L' F'","F D' L D L' D F'","F L D2 L' D2 F'","R' B' D2 B D2 R"],["D'","F L D L' D' F'","D2","L B D B' D' L'","D","B' L' D' L D B","","D F L D L' D' F'"],["F' D2 F D F' D F","F' D' R' D R F","F' R' D' R D F","B D R D' R' B'","","D B' D' L' D L B"],["D F D F' D F D2 F'","F' U2 B' R' B U2 F' L F' L' F'","","D2 L D L2 F L F2 D F"],["L B' L' F L B L' F'","F2 U F' D2 F U' F' D2 F'","D' F' D B D' F D B'","F L2 F R2 F' L2 F R2 F2","D B D' F' D B' D' F","R F L F' R' F L' F'","","D2 B L' U2 L B' D2 B L' U2 L B'","D2 F R' U2 R F' D2 F R' U2 R F'","R F L' F' R' F L F'","D F D' B' D F' D' B","L2 F2 L' B2 L F2 L' B2 L'"],["L B R' B' L' B R B'","R' B R F' R' B' R F","L D2 L U L' D2 L U' L2","","D2 B' D2 F D' L2 F L2 F' D2 B D' F'","D2 F' R' F R2 B' D2 B D2 R' F D2 F'","L B L' F L B' L' F'","F' D2 F' U' F D2 F' U F2","D' B' D F D' B D F'"],["","D2 F' L U2 L' F D2 F' L U2 L' F","D2 B' R U2 R' B D2 B' R U2 R' B"]];async function En(){const i=await re["3x3x3"].kpuzzle();let e=i.defaultPattern();for(const t of yi)e=e.applyAlg(p.fromString(xn(t)));return xi(i,e)?e:En()}async function bn(i){return J(),p.fromString((await Ln).solvePattern(gi(i)))}async function Bn(){return bn(await En())}async function Di(){(await Ln).initialize()}const Si=[[null,"Rw","Rw2","Rw'","Fw","Fw'"],[null,"Dw","Dw2","Dw'"]];async function Ri(){return Fn(await Bn(),Si)}const Nn=V(()=>import("./search-dynamic-solve-4x4x4-C_K4I1n9.js")),vi=[[null,"x","x2","x'","z","z'"],[null,"y","y2","y'"]];async function Fi(){return(await Nn).initialize()}async function zn(){return J(),(await Nn).random444Scramble()}async function Li(){return Fn(await zn(),vi)}const Ei=V(()=>import("./search-dynamic-solve-fto-DNxUWhv2.js"));V(()=>import("./search-dynamic-sgs-unofficial-9zPrATvz.js"));async function bi(){return J(),new p(await(await Ei).getRandomFTOScramble())}const Bi=V(()=>import("./search-dynamic-solve-kilominx-CySGl9Gc.js"));async function Ni(){return J(),(await Bi).getRandomKilominxScramble()}const zi=V(()=>import("./search-dynamic-solve-master_tetraminx-C75VGSxJ.js"));async function Ai(){return J(),new p(await(await zi).randomMasterTetraminxScrambleString())}const ki=2;let _t=null;async function Ti(){return _t||(_t=(async()=>{const i=await(await oe).cachedSGSDataMegaminx();return new rt(await(await oe).cachedMegaminxKPuzzleWithoutMO(),i,["U","R","F","L","BR","BL","FR","FL","DR","DL","B","D"])})())}async function Pi(i){J();const e=await Ti(),t=structuredClone(i.patternData);t.CENTERS.orientation=new Array(12).fill(0);const n=new T(await(await oe).cachedMegaminxKPuzzleWithoutMO(),t);return await e.solve(n,ki,()=>5)}const Ui=3;let qt=null;async function Ii(){return qt||(qt=(async()=>{const i=await(await oe).sgsDataPyraminx();return new rt(await re.pyraminx.kpuzzle(),i,"RLUB".split(""))})())}async function Oi(i){return J(),await(await Ii()).solve(i,Ui,()=>3)}const Ci=V(()=>import("./search-dynamic-sgs-unofficial-9zPrATvz.js"));async function Mi(){return J(),(await Ci).getRandomRediCubeScramble()}const Ki=3;let $t=null;async function Gi(){return $t||($t=(async()=>{const i=await(await oe).sgsDataSkewb();return new rt(await(await oe).skewbKPuzzleWithoutMOCached(),i,"RLUB".split(""))})())}async function _i(i){return new T(await(await oe).skewbKPuzzleWithoutMOCached(),{CORNERS:i.patternData.CORNERS,CENTERS:{pieces:i.patternData.CENTERS.pieces,orientation:new Array(6).fill(0)}})}async function qi(i){return J(),await(await Gi()).solve(await _i(i),Ki,n=>n.family==="y"?4:3)}const $i=V(()=>import("./search-dynamic-solve-sq1-mqPuv8aw.js"));async function Wi(){return p.fromString(await(await $i).getRandomSquare1ScrambleString())}const Qi=1e3;Zr(!0);let An=!0;function Vi(i){An=i}function Wt(){return(typeof performance>"u"?Date:performance).now()}async function K(i,e,t){if(!An)return e();const n=Wt(),r=e();r!=null&&r.then&&await r;const a=Wt();return console.warn(`${i}${t!=null&&t.isPrefetch?" (prefetched)":""}: ${Math.round(a-n)}ms`),r}const ct=new Map;let lt=null,Qt;async function Vt(i,e){return Qt=(async()=>{await Qt;function t(){return K(`wasmRandomScrambleForEvent(${JSON.stringify(i)})`,()=>ui(i),{isPrefetch:e==null?void 0:e.isPrefetch})}switch(i){case"222":return(await t()).experimentalSimplify({puzzleSpecificSimplifyOptions:{quantumMoveOrder:()=>4}});case"555":case"666":case"777":case"333fm":case"minx":case"pyram":case"skewb":case"555bf":return t();case"333":case"333oh":case"333ft":return K("random333Scramble",Bn,{isPrefetch:e==null?void 0:e.isPrefetch});case"333bf":case"333mbf":return K("random333OrientedScramble",Ri);case"444":return K("random444Scramble",zn,{isPrefetch:e==null?void 0:e.isPrefetch});case"444bf":return K("random444OrientedScramble",Li);case"sq1":return K("getRandomSquare1Scramble",Wi,{isPrefetch:e==null?void 0:e.isPrefetch});case"fto":return K("randomFTOScramble",bi,{isPrefetch:e==null?void 0:e.isPrefetch});case"master_tetraminx":return K("randomMasterTetraminxScramble",Ai);case"kilominx":return K("randomKilominxScramble",Ni,{isPrefetch:e==null?void 0:e.isPrefetch});case"redi_cube":return K("randomRediCubeScramble",Mi,{isPrefetch:e==null?void 0:e.isPrefetch});default:throw new Error(`unsupported event: ${i}`)}})()}let mt="auto";const kn={initialize:async i=>{switch(i){case"222":return K("preInitialize222",li);case"333":case"333oh":case"333ft":return K("initialize333",Di);case"444":return K("initialize444",Fi);default:throw new Error(`unsupported event: ${i}`)}},setScramblePrefetchLevel(i){mt=i},randomScrambleForEvent:async i=>{let e=ct.get(i);return e?ct.delete(i):e=Vt(i),mt!=="none"&&e.then(()=>{lt&&clearTimeout(lt),lt=setTimeout(()=>{ct.set(i,Vt(i,{isPrefetch:!0}))},mt==="immediate"?0:Qi)}),e},randomScrambleStringForEvent:async i=>(await kn.randomScrambleForEvent(i)).toString(),solve333ToString:async i=>{const e=new T(await re["3x3x3"].kpuzzle(),i);return(await bn(e)).toString()},solve222ToString:async i=>{const e=new T(await re["2x2x2"].kpuzzle(),i);return(await mi(e)).toString()},solveSkewbToString:async i=>{const e=new T(await re.skewb.kpuzzle(),i);return(await qi(e)).toString()},solvePyraminxToString:async i=>{const e=new T(await re.pyraminx.kpuzzle(),i);return(await Oi(e)).toString()},solveMegaminxToString:async i=>{const e=new T(await re.megaminx.kpuzzle(),i);return(await Pi(e)).toString()},setDebugMeasurePerf:async i=>{Vi(i)},solveTwsearchToString:async(i,e,t)=>{const n=new Z(i),r=new T(n,e);return(await vn(i,r,t)).toString()}};In(kn);var Ji=Object.freeze({__proto__:null});export{p as A,Z as K,o as M,Q,Bn as a,Lt as c,Ji as i,re as p,ei as r};
