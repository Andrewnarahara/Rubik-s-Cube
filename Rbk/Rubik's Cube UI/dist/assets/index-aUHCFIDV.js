const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C0Y7cZ4T.js","assets/index-OVD8mU0B.js","assets/index-BxKBzkJb.css","assets/search-dynamic-sgs-side-events-HldfTfEe.js","assets/parseSGS-BokNUgyO.js","assets/search-dynamic-solve-4x4x4-ssYX3TH6.js","assets/search-worker-entry-ac1qqVK3.js","assets/search-dynamic-solve-fto-BVlsCQ2N.js","assets/search-dynamic-sgs-unofficial-DMqHz_t2.js","assets/search-dynamic-solve-kilominx-BnqznSKz.js","assets/search-dynamic-solve-master_tetraminx-CMhALB8Y.js","assets/search-dynamic-solve-sq1-CXYLeYMv.js"])))=>i.map(i=>d[i]);
var ae=Object.defineProperty;var oe=(t,e,r)=>e in t?ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var A=(t,e,r)=>oe(t,typeof e!="symbol"?e+"":e,r);import{e as ie}from"./search-worker-entry-ac1qqVK3.js";import{r as $,M as b,A as G,K as l,p as L,b as v,d as K,f as U,T as z,c as R,_ as f,h as se,i as ce}from"./index-OVD8mU0B.js";let q=!1;function ue(t){q=t}function F(){if(!q)throw new Error("Must be called from inside a worker, to avoid impact on page performance. Try importing from the top level of `cubing/solve`?")}function W(t,e){const r=new G;r.experimentalPushAlg(t);for(const n of e){const a=$(n);a!==null&&r.push(b.fromString(a))}return r.toAlg()}const le="UF UR UB UL DF DR DB DL FR FL BR BL".split(" "),Fe="UFR URB UBL ULF DRF DFL DLB DBR".split(" "),me="U L F R B D".split(" "),De=[[1,2,0],[0,2,0],[1,1,0],[0,3,0],[2,0,0],[0,1,0],[1,3,0],[0,0,0],[1,0,0],[1,0,2],[0,1,1],[1,1,1],[0,8,1],[2,3,0],[0,10,1],[1,4,1],[0,5,1],[1,7,2],[1,3,2],[0,0,1],[1,0,1],[0,9,0],[2,2,0],[0,8,0],[1,5,1],[0,4,1],[1,4,2],[1,5,0],[0,4,0],[1,4,0],[0,7,0],[2,5,0],[0,5,0],[1,6,0],[0,6,0],[1,7,0],[1,2,2],[0,3,1],[1,3,1],[0,11,1],[2,1,0],[0,9,1],[1,6,1],[0,7,1],[1,5,2],[1,1,2],[0,2,1],[1,2,1],[0,10,0],[2,4,0],[0,11,0],[1,7,1],[0,6,1],[1,6,2]];function _(t,e){return t.slice(e)+t.slice(0,e)}function Re(t){const e=[[],[]];for(let r=0;r<6;r++)if(t.patternData.CENTERS.pieces[r]!==r)throw new Error("non-oriented puzzles are not supported");for(let r=0;r<12;r++)e[0].push(_(le[t.patternData.EDGES.pieces[r]],t.patternData.EDGES.orientation[r]));for(let r=0;r<8;r++)e[1].push(_(Fe[t.patternData.CORNERS.pieces[r]],t.patternData.CORNERS.orientation[r]));return e.push(me),e}function fe(t){const e=Re(t);return De.map(([r,n,a])=>e[r][n][a]).join("")}function M(t,e){const r=new l(t.kpuzzle,{EDGES:t.patternData.EDGES,CORNERS:t.patternData.CORNERS,CENTERS:{pieces:t.patternData.CENTERS.pieces,orientation:new Array(6).fill(0)}}).experimentalToTransformation(),n=new l(e.kpuzzle,{EDGES:e.patternData.EDGES,CORNERS:e.patternData.CORNERS,CENTERS:{pieces:e.patternData.CENTERS.pieces,orientation:new Array(6).fill(0)}}).experimentalToTransformation();return r.isIdentical(n)}function Be(t,e){if(M(t.defaultPattern(),e))return!1;for(const r of"ULFRBD")for(let n=1;n<4;n++){const a=t.moveToTransformation(new b(r,n)).toKPattern();if(M(a,e))return!1}return!0}const Le=[["R U'","R2 B","D2 B2","D' L B'","R' U'","B","D B2","R' B","L' U","L2 B'","B2","D L B'","L U","B'","U'","R B","D' B2","L B'","U2","U L' B'","","U' L' B'","U","L' B'"],["F2 L2","F' L'","R' F L2","D' L2","F L2","F2 L'","R' F' L'","R2 F L2","R2 F2 L'","L2","F L'","D' L","D2 L2","R2 F' L'","D L","","L2 F L'","L F' L2","L F L'","F' L2","L'","D L2","D F L'","L"],["R B U2 B'","R2 B U' B'","F2 B U B'","F B2 L' B2","B2 L B2","B U' B'","R2 B U2 B'","R' B U' B'","B2 L' B2","F B U B'","B2 U' B2","B' L B","L F' B D' B'","B' U' B2 D B'","B U2 B'","R B U' B'","B2 L2 B2","D' B' L B","B U B'","F' B2 L' B2","","B2 L' B' U' B'"],["U F2 L2 U'","F' U L' U'","F2 U L' U'","U F L2 U'","U2 B2 U2","R' U' B U","D2 U L U'","D U2 B' U2","U L2 U'","F U L' U'","D U L U'","U2 B' U2","","U2 B' U' L' U'","U2 L' U2","U' B U","U L U'","D' U2 B' U2","U L' U'","U2 B U2"],["R' D' F2","F'","F2","D R F'","R D' F2","R2 F'","D' F2","R F'","F2 R' D' F2","F","D2 F2","D' R F'","R2 D' F2","R' F'","D F2","D2 R F'","","F R' D' F2"],["R' D2 F' D F","R F2 R2 F2","R2 F' D2 F","F' R2 D2 F","L D' L'","D F' D2 F","F2 R2 F2","R F' D2 F","F' R2 D' F","F' R' D2 F","F2 R' F2","L D L'","F' R D' F","F2 R F2","F' D2 F","","L D2 R D' L'","F' D2 F' R F2","D2 R2 F2 R2 F2","D F' D' F","F' D F"],["U F2 U'","R U F' U'","D R U F2 U'","U F U'","R2 U F2 U'","R' U F' U'","R U F2 U'","R2 U F' U'","","U L D L' F U'","F2 D' R D F2","D2 U F U'","R' U F2 U'","U F' U'","F2 D2 R D2 F2","D U F U'"],["R2","R' B' D B","D R'","F' R2 F","","R B' D B","R'","B' D B","D' R'","D2 F' R2 F","R","R2 B' D B","D2 R'","B' D' B"],["R2 D' R2","F' R' F R","R D' R2 D R'","D2 R2 D2 R2","R' D' F' R F","U F D F' U'","","R2 D2 B R' B' R'","R' F D' F2 R F","R2 D R2","F2 U F U' F","R' D F' R F","D R2 D2 R2","U F D' F' U'","D R' D2 F' R F","R2 D2 R2","U F D2 F' U'","R' D2 F' R F"],["B R B'","F D F' B R2 B'","D B R2 B'","D2 B R' B'","B R2 B'","D B R' B'","D' B R2 B'","B R' B'","","B R2 B' D B R' B'","D2 B R2 B'","D' B R' B'"],["","R' D R F D2 F'","R' D R","D F D' F'","R F' R' F","F D' F'","R' D' R","F D2 F'","R' D2 R","F D F'"],["","F2 D2 R F' R' D2 F' D2 F'","F2 D2 F' D' F D' F' D2 F'","F2 D F2 D F2 D2 F2","D2 F L D2 L' D2 F'","D F D2 L D2 L' F'","R' D B' D2 B D' R","R' D2 B' D2 B R","F D2 F' D F D F'","F D' L D2 L' D F'","B D' F D B' D' F'","F D2 L D2 L' F'","F D' L D L' D F'","F L D2 L' D2 F'","R' B' D2 B D2 R"],["D'","F L D L' D' F'","D2","L B D B' D' L'","D","B' L' D' L D B","","D F L D L' D' F'"],["F' D2 F D F' D F","F' D' R' D R F","F' R' D' R D F","B D R D' R' B'","","D B' D' L' D L B"],["D F D F' D F D2 F'","F' U2 B' R' B U2 F' L F' L' F'","","D2 L D L2 F L F2 D F"],["L B' L' F L B L' F'","F2 U F' D2 F U' F' D2 F'","D' F' D B D' F D B'","F L2 F R2 F' L2 F R2 F2","D B D' F' D B' D' F","R F L F' R' F L' F'","","D2 B L' U2 L B' D2 B L' U2 L B'","D2 F R' U2 R F' D2 F R' U2 R F'","R F L' F' R' F L F'","D F D' B' D F' D' B","L2 F2 L' B2 L F2 L' B2 L'"],["L B R' B' L' B R B'","R' B R F' R' B' R F","L D2 L U L' D2 L U' L2","","D2 B' D2 F D' L2 F L2 F' D2 B D' F'","D2 F' R' F R2 B' D2 B D2 R' F D2 F'","L B L' F L B' L' F'","F' D2 F' U' F D2 F' U F2","D' B' D F D' B D F'"],["","D2 F' L U2 L' F D2 F' L U2 L' F","D2 B' R U2 R' B D2 B' R U2 R' B"]];async function V(){const t=await L["3x3x3"].kpuzzle();let e=t.defaultPattern();for(const r of Le)e=e.applyAlg(v.fromString($(r)));return Be(t,e)?e:V()}async function Q(t){return F(),v.fromString((await K).solvePattern(fe(t)))}async function j(){return Q(await V())}async function de(){(await K).initialize()}const we=[[null,"Rw","Rw2","Rw'","Fw","Fw'"],[null,"Dw","Dw2","Dw'"]];async function Se(){return W(await j(),we)}var S=(t=>(t.OuterBlockTurnMetric="OBTM",t.RangeBlockTurnMetric="RBTM",t.SingleSliceTurnMetric="SSTM",t.OuterBlockQuantumTurnMetric="OBQTM",t.RangeBlockQuantumTurnMetric="RBQTM",t.SingleSliceQuantumTurnMetric="SSQTM",t.ExecutionTurnMetric="ETM",t))(S||{});S.OuterBlockTurnMetric+"",S.RangeBlockTurnMetric+"",S.OuterBlockQuantumTurnMetric+"",S.RangeBlockQuantumTurnMetric+"",S.ExecutionTurnMetric+"";class g extends z{constructor(e){super(),this.metric=e}traverseAlg(e){let r=0;for(const n of e.childAlgNodes())r+=this.traverseAlgNode(n);return r}traverseGrouping(e){const r=e.alg;return this.traverseAlg(r)*Math.abs(e.amount)}traverseMove(e){return this.metric(e)}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 0}traverseNewline(e){return 0}traverseLineComment(e){return 0}}class ve extends z{traverseAlg(e){let r=0;for(const n of e.childAlgNodes())r+=this.traverseAlgNode(n);return r}traverseGrouping(e){const r=e.alg;return this.traverseAlg(r)*Math.abs(e.amount)}traverseMove(e){return 1}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 1}traverseNewline(e){return 1}traverseLineComment(e){return 1}}function H(t){return"A"<=t&&t<="Z"}function J(t){const e=t.family;return H(e[0])&&e[e.length-1]==="v"||e==="x"||e==="y"||e==="z"||e==="T"?0:1}function Ue(t){return 1}function Z(t){const e=t.family;return H(e[0])&&e[e.length-1]==="v"||e==="x"||e==="y"||e==="z"||e==="T"?0:1}function he(t){return Math.abs(t.amount)*Z(t)}const ge=U(g,[J]);U(g,[Ue]);U(g,[he]);U(g,[Z]);U(ve,[J]);class pe extends z{traverseAlg(e){let r=0;for(const n of e.childAlgNodes())r+=this.traverseAlgNode(n);return r}traverseGrouping(e){return this.traverseAlg(e.alg)*Math.abs(e.amount)}traverseMove(e){return 1}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 1}traverseNewline(e){return 0}traverseLineComment(e){return 0}}U(pe);const Te=2;function Ee(t,e){const r=[];for(const n of e){const a=new b(n);if(a.amount!==1)throw new Error("SGS cannot handle def moves with an amount other than 1 yet.");let o=t.identityTransformation();for(let s=1;o=o.applyMove(a),!o.isIdentityTransformation();s++)r.push({move:a.modified({amount:s}),transformation:o})}return r}class p{constructor(e,r,n){A(this,"searchMoves");this.kpuzzle=e,this.sgs=r,this.searchMoves=Ee(this.kpuzzle,n??Object.keys(this.kpuzzle.definition.moves))}async solve(e,r=Te,n){const a=e.experimentalToTransformation();if(!a)throw new Error("distinguishable pieces are not supported in tremble solver yt");let o=null,s=1e6;const h=(m,w,u)=>{if(w===0){const c=this.sgsPhaseSolve(m,s);if(!c)return;const B=u.concat(c).experimentalSimplify({cancel:{directional:"any-direction",puzzleSpecificModWrap:"canonical-centered"},puzzleSpecificSimplifyOptions:{quantumMoveOrder:n}}),D=ge(B);(o===null||D<s)&&(o=B,s=D);return}for(const c of this.searchMoves)h(m.applyTransformation(c.transformation),w-1,u.concat([c.move]))};for(let m=0;m<=r;m++)h(a,m,new v);if(o===null)throw new Error("SGS search failed.");return o}sgsPhaseSolve(e,r){const n=new G;let a=e;for(const o of this.sgs.ordering){const s=o.pieceOrdering;let h="";const m=a.invert();for(let u=0;u<s.length;u++){const c=s[u],B=c.orbitName,D=c.permutationIdx;h+=` ${m.transformationData[B].permutation[D]} ${m.transformationData[B].orientationDelta[D]}`}const w=o.lookup[h];if(!w)throw new Error("Missing algorithm in sgs or esgs?");if(n.experimentalPushAlg(w.alg),n.experimentalNumAlgNodes()>=r)return null;a=a.applyTransformation(w.transformation);for(let u=0;u<s.length;u++){const c=s[u],B=c.orbitName,D=c.permutationIdx;if(a.transformationData[B].permutation[D]!==D||a.transformationData[B].orientationDelta[D]!==0)throw new Error("bad SGS :-(")}}return n.toAlg()}}const X=R(async()=>f(()=>import("./index-C0Y7cZ4T.js"),__vite__mapDeps([0,1,2])));async function Y(t,e,r){const{wasmTwsearch:n}=await X;return n(t,e,r)}async function ye(t){const{wasmRandomScrambleForEvent:e}=await X;return e(t)}const d=R(()=>f(()=>import("./search-dynamic-sgs-side-events-HldfTfEe.js"),__vite__mapDeps([3,1,2,4])));let x=null;async function be(){return x||(x=(async()=>{const t=await(await d).cachedData222();return new p(await L["2x2x2"].kpuzzle(),t,"URFLBD".split(""))})())}async function ze(){await be()}async function Ae(t){return F(),Y((await se.kpuzzle()).definition,t,{generatorMoves:"UFLR".split("")})}const ee=R(()=>f(()=>import("./search-dynamic-solve-4x4x4-ssYX3TH6.js"),__vite__mapDeps([5,1,2,6]))),_e=[[null,"x","x2","x'","z","z'"],[null,"y","y2","y'"]];async function Me(){return(await ee).initialize()}async function te(){return F(),(await ee).random444Scramble()}async function xe(){return W(await te(),_e)}const Pe=R(()=>f(()=>import("./search-dynamic-solve-fto-BVlsCQ2N.js"),__vite__mapDeps([7,1,2])));R(()=>f(()=>import("./search-dynamic-sgs-unofficial-DMqHz_t2.js"),__vite__mapDeps([8,1,2,4])));async function Oe(){return F(),new v(await(await Pe).getRandomFTOScramble())}const ke=R(()=>f(()=>import("./search-dynamic-solve-kilominx-BnqznSKz.js"),__vite__mapDeps([9,1,2])));async function Ce(){return F(),(await ke).getRandomKilominxScramble()}const Ne=R(()=>f(()=>import("./search-dynamic-solve-master_tetraminx-CMhALB8Y.js"),__vite__mapDeps([10,1,2])));async function Ie(){return F(),new v(await(await Ne).randomMasterTetraminxScrambleString())}const $e=2;let P=null;async function Ge(){return P||(P=(async()=>{const t=await(await d).cachedSGSDataMegaminx();return new p(await(await d).cachedMegaminxKPuzzleWithoutMO(),t,["U","R","F","L","BR","BL","FR","FL","DR","DL","B","D"])})())}async function Ke(t){F();const e=await Ge(),r=structuredClone(t.patternData);r.CENTERS.orientation=new Array(12).fill(0);const n=new l(await(await d).cachedMegaminxKPuzzleWithoutMO(),r);return await e.solve(n,$e,()=>5)}const qe=3;let O=null;async function We(){return O||(O=(async()=>{const t=await(await d).sgsDataPyraminx();return new p(await L.pyraminx.kpuzzle(),t,"RLUB".split(""))})())}async function Ve(t){return F(),await(await We()).solve(t,qe,()=>3)}const Qe=R(()=>f(()=>import("./search-dynamic-sgs-unofficial-DMqHz_t2.js"),__vite__mapDeps([8,1,2,4])));async function je(){return F(),(await Qe).getRandomRediCubeScramble()}const He=3;let k=null;async function Je(){return k||(k=(async()=>{const t=await(await d).sgsDataSkewb();return new p(await(await d).skewbKPuzzleWithoutMOCached(),t,"RLUB".split(""))})())}async function Ze(t){return new l(await(await d).skewbKPuzzleWithoutMOCached(),{CORNERS:t.patternData.CORNERS,CENTERS:{pieces:t.patternData.CENTERS.pieces,orientation:new Array(6).fill(0)}})}async function Xe(t){return F(),await(await Je()).solve(await Ze(t),He,n=>n.family==="y"?4:3)}const Ye=R(()=>f(()=>import("./search-dynamic-solve-sq1-CXYLeYMv.js"),__vite__mapDeps([11,1,2])));async function et(){return v.fromString(await(await Ye).getRandomSquare1ScrambleString())}const tt=1e3;ue(!0);let re=!0;function rt(t){re=t}function C(){return(typeof performance>"u"?Date:performance).now()}async function i(t,e,r){if(!re)return e();const n=C(),a=e();a!=null&&a.then&&await a;const o=C();return console.warn(`${t}${r!=null&&r.isPrefetch?" (prefetched)":""}: ${Math.round(o-n)}ms`),a}const T=new Map;let E=null,N;async function I(t,e){return N=(async()=>{await N;function r(){return i(`wasmRandomScrambleForEvent(${JSON.stringify(t)})`,()=>ye(t),{isPrefetch:e==null?void 0:e.isPrefetch})}switch(t){case"222":return(await r()).experimentalSimplify({puzzleSpecificSimplifyOptions:{quantumMoveOrder:()=>4}});case"555":case"666":case"777":case"333fm":case"minx":case"pyram":case"skewb":case"555bf":return r();case"333":case"333oh":case"333ft":return i("random333Scramble",j,{isPrefetch:e==null?void 0:e.isPrefetch});case"333bf":case"333mbf":return i("random333OrientedScramble",Se);case"444":return i("random444Scramble",te,{isPrefetch:e==null?void 0:e.isPrefetch});case"444bf":return i("random444OrientedScramble",xe);case"sq1":return i("getRandomSquare1Scramble",et,{isPrefetch:e==null?void 0:e.isPrefetch});case"fto":return i("randomFTOScramble",Oe,{isPrefetch:e==null?void 0:e.isPrefetch});case"master_tetraminx":return i("randomMasterTetraminxScramble",Ie);case"kilominx":return i("randomKilominxScramble",Ce,{isPrefetch:e==null?void 0:e.isPrefetch});case"redi_cube":return i("randomRediCubeScramble",je,{isPrefetch:e==null?void 0:e.isPrefetch});default:throw new Error(`unsupported event: ${t}`)}})()}let y="auto";const ne={initialize:async t=>{switch(t){case"222":return i("preInitialize222",ze);case"333":case"333oh":case"333ft":return i("initialize333",de);case"444":return i("initialize444",Me);default:throw new Error(`unsupported event: ${t}`)}},setScramblePrefetchLevel(t){y=t},randomScrambleForEvent:async t=>{let e=T.get(t);return e?T.delete(t):e=I(t),y!=="none"&&e.then(()=>{E&&clearTimeout(E),E=setTimeout(()=>{T.set(t,I(t,{isPrefetch:!0}))},y==="immediate"?0:tt)}),e},randomScrambleStringForEvent:async t=>(await ne.randomScrambleForEvent(t)).toString(),solve333ToString:async t=>{const e=new l(await L["3x3x3"].kpuzzle(),t);return(await Q(e)).toString()},solve222ToString:async t=>{const e=new l(await L["2x2x2"].kpuzzle(),t);return(await Ae(e)).toString()},solveSkewbToString:async t=>{const e=new l(await L.skewb.kpuzzle(),t);return(await Xe(e)).toString()},solvePyraminxToString:async t=>{const e=new l(await L.pyraminx.kpuzzle(),t);return(await Ve(e)).toString()},solveMegaminxToString:async t=>{const e=new l(await L.megaminx.kpuzzle(),t);return(await Ke(e)).toString()},setDebugMeasurePerf:async t=>{rt(t)},solveTwsearchToString:async(t,e,r)=>{const n=new ce(t),a=new l(n,e);return(await Y(t,a,r)).toString()}};ie(ne);const it=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{it as i,j as r};
